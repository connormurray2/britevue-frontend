import { VALUE_CHANGED_SYNC, PATCH } from "../const/app.const";
import { isMatched, clone } from './entity.service';
import { ObjectMaker } from '../util/object-maker';
import { AbstractFormArray } from "../abstract/abstract-form-array";
const PROP_ARRAY = "propArray";
export class RxFormArray extends AbstractFormArray {
    constructor(arrayObject, controls, validatorOrOpts, asyncValidator, arrayConfig) {
        super(controls);
        this.arrayObject = arrayObject;
        this.arrayConfig = arrayConfig;
        this._baseValue = [];
        this._isModified = false;
        this._modified = [];
        this.cloneObject(arrayObject);
    }
    get isModified() {
        return this._isModified;
    }
    push(control) {
        let formGroup = this.root;
        if (this.arrayObject)
            if (control.modelInstance)
                this.arrayObject.push(control.modelInstance);
        super.push(control);
        if (formGroup[VALUE_CHANGED_SYNC])
            formGroup.valueChangedSync();
        this.patch();
        this.checkValidation();
    }
    patch() {
        this.checkModification();
        if (this.parent)
            this.parent[PATCH]();
    }
    resetForm(options) {
        if (options && options.index >= 0 && options.groupOption) {
            this.controls[options.index].resetForm(options.groupOption);
        }
        else {
            for (var i = 0; i < this._baseValue.length; i++) {
                if (this.controls[i] !== undefined)
                    this.controls[i].resetForm({ value: this._baseValue[i] });
                else if (options && options.pushFunction) {
                    let formGroup = options.pushFunction(this._baseValue[i]);
                    this.push(formGroup);
                }
            }
        }
    }
    commit() {
        this._baseValue = [];
        for (let formGroup of this.controls) {
            formGroup.commit();
            this._baseValue.push(clone(formGroup.value));
        }
        this.patch();
    }
    removeAt(index) {
        let formGroup = this.root;
        this.arrayObject.splice(index, 1);
        super.removeAt(index);
        if (formGroup[VALUE_CHANGED_SYNC])
            formGroup.valueChangedSync();
        this.patch();
        this.checkValidation();
    }
    checkValidation() {
        setTimeout(() => {
            if (this.arrayConfig != undefined && this.arrayConfig.allowMaxIndex && this.length > this.arrayConfig.allowMaxIndex)
                this.setErrors(ObjectMaker.toJson(PROP_ARRAY, this.arrayConfig, [this.length, this.arrayConfig.allowMaxIndex]));
            else if (this.errors && this.errors[PROP_ARRAY])
                delete this.errors[PROP_ARRAY];
        });
    }
    checkModification() {
        this._isModified = !(this._baseValue.length == this.controls.length);
        if (!this._isModified)
            for (var i = 0; i < this.controls.length; i++) {
                this._isModified = isMatched(this._baseValue[i], this.controls[i].value);
                if (this._isModified)
                    break;
            }
    }
    cloneObject(value) {
        this._baseValue = [];
        for (let row of value) {
            this._baseValue.push(clone(row));
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicngtZm9ybS1hcnJheS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0ByeHdlYi9yZWFjdGl2ZS1mb3Jtcy8iLCJzb3VyY2VzIjpbInNlcnZpY2VzL3J4LWZvcm0tYXJyYXkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGtCQUFrQixFQUFFLEtBQUssRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQy9ELE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLE1BQU0sa0JBQWtCLENBQUE7QUFFbkQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHNCQUFzQixDQUFBO0FBQ2xELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBQ3BFLE1BQU0sVUFBVSxHQUFXLFdBQVcsQ0FBQztBQUN2QyxNQUFNLE9BQU8sV0FBWSxTQUFRLGlCQUFpQjtJQUs5QyxZQUFvQixXQUFrQixFQUFFLFFBQWMsRUFBRSxlQUFxQixFQUFFLGNBQW9CLEVBQVUsV0FBd0Q7UUFDakssS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBREEsZ0JBQVcsR0FBWCxXQUFXLENBQU87UUFBdUUsZ0JBQVcsR0FBWCxXQUFXLENBQTZDO1FBSjdKLGVBQVUsR0FBVSxFQUFFLENBQUM7UUFDdkIsZ0JBQVcsR0FBWSxLQUFLLENBQUM7UUFDN0IsY0FBUyxHQUFVLEVBQUUsQ0FBQztRQUkxQixJQUFJLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFFRCxJQUFJLFVBQVU7UUFDVixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUM7SUFDNUIsQ0FBQztJQUVELElBQUksQ0FBQyxPQUFXO1FBQ1osSUFBSSxTQUFTLEdBQU8sSUFBSSxDQUFDLElBQUksQ0FBQztRQUM5QixJQUFHLElBQUksQ0FBQyxXQUFXO1lBQ2YsSUFBRyxPQUFPLENBQUMsYUFBYTtnQkFDcEIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEs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QUksSUFBSSxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQztnQkFDM0MsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ3ZDLENBQUMsQ0FBQyxDQUFBO0lBQ04sQ0FBQztJQUVPLGlCQUFpQjtRQUNyQixJQUFJLENBQUMsV0FBVyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ3JFLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVztZQUNqQixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7Z0JBQzNDLElBQUksQ0FBQyxXQUFXLEdBQUcsU0FBUyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQTtnQkFDeEUsSUFBSSxJQUFJLENBQUMsV0FBVztvQkFDaEIsTUFBTTthQUNiO0lBQ1QsQ0FBQztJQUVPLFdBQVcsQ0FBQyxLQUFZO1FBQzVCLElBQUksQ0FBQyxVQUFVLEdBQUcsRUFBRSxDQUFDO1FBQ3JCLEtBQUssSUFBSSxHQUFHLElBQUksS0FBSyxFQUFFO1lBQ25CLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1NBQ3BDO0lBQ0wsQ0FBQztDQUdKIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVkFMVUVfQ0hBTkdFRF9TWU5DLCBQQVRDSCB9IGZyb20gXCIuLi9jb25zdC9hcHAuY29uc3RcIjtcclxuaW1wb3J0IHsgaXNNYXRjaGVkLCBjbG9uZSB9IGZyb20gJy4vZW50aXR5LnNlcnZpY2UnXHJcbmltcG9ydCB7IFJlc2V0Rm9ybVR5cGUgfSBmcm9tIFwiLi4vZW51bXMvcmVzZXQtdHlwZVwiO1xyXG5pbXBvcnQgeyBPYmplY3RNYWtlciB9IGZyb20gJy4uL3V0aWwvb2JqZWN0LW1ha2VyJ1xyXG5pbXBvcnQgeyBBYnN0cmFjdEZvcm1BcnJheSB9IGZyb20gXCIuLi9hYnN0cmFjdC9hYnN0cmFjdC1mb3JtLWFycmF5XCI7XHJcbmNvbnN0IFBST1BfQVJSQVk6IHN0cmluZyA9IFwicHJvcEFycmF5XCI7XHJcbmV4cG9ydCBjbGFzcyBSeEZvcm1BcnJheSBleHRlbmRzIEFic3RyYWN0Rm9ybUFycmF5IHtcclxuICAgIHByaXZhdGUgX2Jhc2VWYWx1ZTogYW55W10gPSBbXTtcclxuICAgIHByaXZhdGUgX2lzTW9kaWZpZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIHByaXZhdGUgX21vZGlmaWVkOiBhbnlbXSA9IFtdO1xyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGFycmF5T2JqZWN0OiBhbnlbXSwgY29udHJvbHM6YW55W10sIHZhbGlkYXRvck9yT3B0cz86IGFueSwgYXN5bmNWYWxpZGF0b3I/OiBhbnksIHByaXZhdGUgYXJyYXlDb25maWc/OiB7YWxsb3dNYXhJbmRleD86bnVtYmVyLG1lc3NhZ2VLZXk/OnN0cmluZ30pe1xyXG4gICAgICAgIHN1cGVyKGNvbnRyb2xzKTtcclxuICAgICAgICB0aGlzLmNsb25lT2JqZWN0KGFycmF5T2JqZWN0KTsgICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGdldCBpc01vZGlmaWVkKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pc01vZGlmaWVkO1xyXG4gICAgfVxyXG5cclxuICAgIHB1c2goY29udHJvbDphbnkpe1xyXG4gICAgICAgIGxldCBmb3JtR3JvdXA6YW55ID0gdGhpcy5yb290O1xyXG4gICAgICAgIGlmKHRoaXMuYXJyYXlPYmplY3QpXHJcbiAgICAgICAgICAgIGlmKGNvbnRyb2wubW9kZWxJbnN0YW5jZSlcclxuICAgICAgICAgICAgICAgIHRoaXMuYXJyYXlPYmplY3QucHVzaChjb250cm9sLm1vZGVsSW5zdGFuY2UpO1xyXG4gICAgICAgIHN1cGVyLnB1c2goY29udHJvbCk7XHJcbiAgICAgICAgaWYoZm9ybUdyb3VwW1ZBTFVFX0NIQU5HRURfU1lOQ10pXHJcbiAgICAgICAgICAgIGZvcm1Hcm91cC52YWx1ZUNoYW5nZWRTeW5jKClcclxuICAgICAgICB0aGlzLnBhdGNoKClcclxuICAgICAgICB0aGlzLmNoZWNrVmFsaWRhdGlvbigpIFxyXG4gICAgfVxyXG5cclxuICAgIHBhdGNoKCkge1xyXG4gICAgICAgIHRoaXMuY2hlY2tNb2RpZmljYXRpb24oKTtcclxuICAgICAgICBpZiAodGhpcy5wYXJlbnQpXHJcbiAgICAgICAgICAgIHRoaXMucGFyZW50W1BBVENIXSgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByZXNldEZvcm0ob3B0aW9ucz86IHtcclxuICAgICAgICBpbmRleDogbnVtYmVyLFxyXG4gICAgICAgIGdyb3VwT3B0aW9uOiB7XHJcbiAgICAgICAgICAgIHJlc2V0VHlwZT86IFJlc2V0Rm9ybVR5cGUsXHJcbiAgICAgICAgICAgIHdpdGg/OiBzdHJpbmdbXSxcclxuICAgICAgICAgICAgdmFsdWU/OiB7IFtrZXk6IHN0cmluZ106IGFueSB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBwdXNoRnVuY3Rpb246ICh2YWx1ZTpPYmplY3QpID0+IGJvb2xlYW47XHJcbiAgICB9KSB7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5pbmRleCA+PSAwICYmIG9wdGlvbnMuZ3JvdXBPcHRpb24pIHtcclxuICAgICAgICAgICAgKDxhbnk+dGhpcy5jb250cm9sc1tvcHRpb25zLmluZGV4XSkucmVzZXRGb3JtKG9wdGlvbnMuZ3JvdXBPcHRpb24pXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9iYXNlVmFsdWUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbnRyb2xzW2ldICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAgICAgICAgICAgICAgKDxhbnk+dGhpcy5jb250cm9sc1tpXSkucmVzZXRGb3JtKHsgdmFsdWU6IHRoaXMuX2Jhc2VWYWx1ZVtpXSB9KTtcclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLnB1c2hGdW5jdGlvbilcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmb3JtR3JvdXAgPSBvcHRpb25zLnB1c2hGdW5jdGlvbih0aGlzLl9iYXNlVmFsdWVbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnB1c2goZm9ybUdyb3VwKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuXHJcbiAgICBjb21taXQoKSB7XHJcbiAgICAgICAgdGhpcy5fYmFzZVZhbHVlID0gW11cclxuICAgICAgICBmb3IgKGxldCBmb3JtR3JvdXAgb2YgdGhpcy5jb250cm9scykge1xyXG4gICAgICAgICAgICAoPGFueT5mb3JtR3JvdXApLmNvbW1pdCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9iYXNlVmFsdWUucHVzaChjbG9uZShmb3JtR3JvdXAudmFsdWUpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5wYXRjaCgpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICByZW1vdmVBdChpbmRleDpudW1iZXIpe1xyXG4gICAgICAgIGxldCBmb3JtR3JvdXA6YW55ID0gdGhpcy5yb290O1xyXG4gICAgICAgIHRoaXMuYXJyYXlPYmplY3Quc3BsaWNlKGluZGV4LDEpO1xyXG4gICAgICAgIHN1cGVyLnJlbW92ZUF0KGluZGV4KTtcclxuICAgICAgICBpZihmb3JtR3JvdXBbVkFMVUVfQ0hBTkdFRF9TWU5DXSlcclxuICAgICAgICAgICAgZm9ybUdyb3VwLnZhbHVlQ2hhbmdlZFN5bmMoKVxyXG4gICAgICAgIHRoaXMucGF0Y2goKVxyXG4gICAgICAgIHRoaXMuY2hlY2tWYWxpZGF0aW9uKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjaGVja1ZhbGlkYXRpb24oKSB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFycmF5Q29uZmlnICE9IHVuZGVmaW5lZCAmJiB0aGlzLmFycmF5Q29uZmlnLmFsbG93TWF4SW5kZXggJiYgdGhpcy5sZW5ndGggPiB0aGlzLmFycmF5Q29uZmlnLmFsbG93TWF4SW5kZXgpXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldEVycm9ycyhPYmplY3RNYWtlci50b0pzb24oUFJPUF9BUlJBWSwgdGhpcy5hcnJheUNvbmZpZywgW3RoaXMubGVuZ3RoLCB0aGlzLmFycmF5Q29uZmlnLmFsbG93TWF4SW5kZXhdKSk7XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuZXJyb3JzICYmIHRoaXMuZXJyb3JzW1BST1BfQVJSQVldKVxyXG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuZXJyb3JzW1BST1BfQVJSQVldO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjaGVja01vZGlmaWNhdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9pc01vZGlmaWVkID0gISh0aGlzLl9iYXNlVmFsdWUubGVuZ3RoID09IHRoaXMuY29udHJvbHMubGVuZ3RoKTtcclxuICAgICAgICBpZiAoIXRoaXMuX2lzTW9kaWZpZWQpXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5jb250cm9scy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faXNNb2RpZmllZCA9IGlzTWF0Y2hlZCh0aGlzLl9iYXNlVmFsdWVbaV0sIHRoaXMuY29udHJvbHNbaV0udmFsdWUpXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNNb2RpZmllZClcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY2xvbmVPYmplY3QodmFsdWU6IGFueVtdKSB7XHJcbiAgICAgICAgdGhpcy5fYmFzZVZhbHVlID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgcm93IG9mIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2Jhc2VWYWx1ZS5wdXNoKGNsb25lKHJvdykpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG59XHJcbiJdfQ==