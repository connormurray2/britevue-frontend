{"remainingRequest":"/home/cmurray/britevue-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/cmurray/britevue-frontend/src/layouts/dashboard/Header/Header.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/home/cmurray/britevue-frontend/src/layouts/dashboard/Header/Header.vue","mtime":1628691920056},{"path":"/home/cmurray/britevue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/cmurray/britevue-frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/cmurray/britevue-frontend/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/home/cmurray/britevue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/cmurray/britevue-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgppbXBvcnQge1Z1ZSwgQ29tcG9uZW50LCBJbmplY3R9IGZyb20gJ3Z1ZS1wcm9wZXJ0eS1kZWNvcmF0b3InOwppbXBvcnQge1VzZXJTZXJ2aWNlfSBmcm9tICJAL3NlcnZpY2VzL1VzZXJTZXJ2aWNlIjsKaW1wb3J0IHtJVXNlcn0gZnJvbSAiQC9pbnRlcmZhY2VzL0lVc2VyIjsKaW1wb3J0IHtOb3RpZmljYXRpb25zU2VydmljZX0gZnJvbSAiQC9zZXJ2aWNlcy9Ob3RmaWNhdGlvbnNTZXJ2aWNlIjsKaW1wb3J0IFZ1ZUdvb2dsZUF1dG9jb21wbGV0ZSBmcm9tICJ2dWUtZ29vZ2xlLWF1dG9jb21wbGV0ZSI7CmltcG9ydCBMb2dpbiBmcm9tICJAL2NvbXBvbmVudHMvTG9naW4vTG9naW4udnVlIjsKaW1wb3J0IFNpZ251cCBmcm9tICJAL2NvbXBvbmVudHMvU2lnbnVwL1NpZ251cC52dWUiOwoKQENvbXBvbmVudCh7CiAgY29tcG9uZW50czogewogICAgVnVlR29vZ2xlQXV0b2NvbXBsZXRlLAogICAgTG9naW4sCiAgICBTaWdudXAsCiAgfQp9KQpleHBvcnQgZGVmYXVsdCBjbGFzcyBIZWFkZXIgZXh0ZW5kcyBWdWV7CiAgQEluamVjdCgndXNlclNlcnZpY2UnKQogIHVzZXJfc2VyITogVXNlclNlcnZpY2U7CgogIEBJbmplY3QoJ25vdGlmaWNhdGlvbnNTZXJ2aWNlJykKICBub3RpZmljYXRpb25fc2VydmljZSE6IE5vdGlmaWNhdGlvbnNTZXJ2aWNlOwogIG5vdGlmaWNhdGlvbnM6IFtdIHwgbnVsbDsKICB1c2VyOiBJVXNlcnxudWxsID0gbnVsbDsKICBzaG93U2VhcmNoQmFyOiBib29sZWFuOwogIHRvb2x0aXAgPSB0cnVlOwogIHBsYWNlOiBhbnkgfCBudWxsID0gbnVsbDsKICBvcGVuZWRNZW51ID0gZmFsc2U7CiAgY29uc3RydWN0b3IoKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy5ub3RpZmljYXRpb25zPVtdOwogICAgdGhpcy5zaG93U2VhcmNoQmFyPSB0cnVlOwogICAgLyppZih0aGlzLiRyb3V0ZS5uYW1lPT0nbGFuZGluZycpewogICAgICB0aGlzLnNob3dTZWFyY2hCYXI9IGZhbHNlOwogICAgfSovCiAgfQoKICBhc3luYyBtb3VudGVkKCl7CiAgICBpZiAodGhpcy4kcm91dGUucXVlcnkudG9rZW4gIT0gbnVsbCAmJiB0aGlzLiRyb3V0ZS5xdWVyeS51c2VybmFtZSAhPSBudWxsKSB7CiAgICAgIGNvbnN0IHRva2VuT2JqID0gewogICAgICAgIHVzZXJuYW1lOiB0aGlzLiRyb3V0ZS5xdWVyeS51c2VybmFtZSwKICAgICAgICB0b2tlbjogdGhpcy4kcm91dGUucXVlcnkudG9rZW4sCiAgICAgICAgZXhwaXJlc19hdDogdGhpcy4kcm91dGUucXVlcnkuZXhwaXJlc19hdAogICAgICB9CiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd0b2tlbicsIEpTT04uc3RyaW5naWZ5KHRva2VuT2JqKSkKICAgICAgYXdhaXQgdGhpcy51c2VyX3Nlci51cGRhdGVVc2VyTG9jYWxTdG9yYWdlKHRoaXMuJHJvdXRlLnF1ZXJ5LnVzZXJuYW1lIGFzIHN0cmluZykKICAgICAgY29uc3QgcXVlcnkgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLiRyb3V0ZS5xdWVyeSk7CiAgICAgIGRlbGV0ZSBxdWVyeS50b2tlbjsKICAgICAgZGVsZXRlIHF1ZXJ5LmV4cGlyZXNfYXQ7CiAgICAgIGRlbGV0ZSBxdWVyeS51c2VybmFtZTsKICAgICAgdGhpcy4kcm91dGVyLnJlcGxhY2UoeyBxdWVyeSB9KTsKICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpCiAgICB9CiAgICBjb25zdCB1c2VyID0gdGhpcy51c2VyX3Nlci5nZXRDdXJyZW50VXNlcigpOwogICAgaWYodXNlcil7CiAgICAgIHRoaXMudXNlciA9IHVzZXI7CiAgICAgIC8vIFdlaXJkIGhhY2sgZm9yIGhhbmRjYXNoIHNpbmNlIHdlIGRvbid0IGhhdmUgbGFzdG5hbWUgYWxsIHRoZSB0aW1lCiAgICAgIGlmICh0aGlzLnVzZXIubGFzdE5hbWUgPT0gbnVsbCkgewogICAgICAgIHRoaXMudXNlci5sYXN0TmFtZSA9ICIiCiAgICAgIH0KICAgICAgY29uc3QgeD0gYXdhaXQgdGhpcy5ub3RpZmljYXRpb25fc2VydmljZS5nZXRVc2VyTm90aWZpY2F0aW9ucygpOwogICAgICBpZih4LnN0YXR1cz09MjAwKXsKICAgICAgIHRoaXMubm90aWZpY2F0aW9ucz14LmRhdGEubm90aWZpY2F0aW9uczsKICAgICAgfQogICAgfQogIH0KCiAgZ29Ib21lKCkgewogICAgdGhpcy4kcm91dGVyLnB1c2goe25hbWU6ICJob21lIn0pOwogIH0KICBnZXRBZGRyZXNzRGF0YSgpIHsKICAgIGNvbnNvbGUubG9nKCdoJykKICB9CiAgZ2V0Um91dGVQYXRoKG5hbWU6IHN0cmluZyxwYXJhbWV0ZXJzOiBhbnkpewogICAgcmV0dXJuIHRoaXMuJHJvdXRlci5wdXNoKHtuYW1lOiBuYW1lLCBwYXJhbXM6IHBhcmFtZXRlcnN9KTsKICB9CiAgYXN5bmMgbG9nb3V0KCl7CiAgICBhd2FpdCB0aGlzLnVzZXJfc2VyLmxvZ291dCgpOwogICAgaWYodGhpcy4kcm91dGUubmFtZT09J2hvbWUnKSB7CiAgICAgIGxvY2F0aW9uLnJlbG9hZCgpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goe25hbWU6ICJob21lIn0pOwogICAgfQogIH0KICBmaW5kUGxhY2VDaGFuZ2VkKHJldDogYW55LCBwbGFjZTogYW55LCBpZDogYW55KSB7CiAgICB0aGlzLnBsYWNlID0gcGxhY2U7CiAgICBpZiAodHlwZW9mIHBsYWNlLnBsYWNlX2lkICE9ICJ1bmRlZmluZWQiKSB7CiAgICAgIHRoaXMuZ2V0Um91dGVQYXRoKCJwbGFjZSIsIHsgaWQ6IHBsYWNlLnBsYWNlX2lkIH0pOwogICAgICBpZih0aGlzLiRyb3V0ZS5uYW1lPT0ncGxhY2UnKXsKICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgfQogICAgfQogIH0KICBoaWRlVG9vbHRpcCgpIHsKICAgIHRoaXMudG9vbHRpcCA9IGZhbHNlOwogIH0KICBzaG93VG9vbHRpcCgpIHsKICAgIHRoaXMudG9vbHRpcCA9IHRydWU7CiAgfQogIG9wZW5NZW51KCl7CiAgICB0aGlzLm9wZW5lZE1lbnUgPSAhdGhpcy5vcGVuZWRNZW51OwogIH0KCgogIG9wZW5Mb2dpbigpIHsKICAgICh0aGlzLiRyZWZzWyJsb2dpbiJdIGFzIGFueSkuc2hvd01vZGFsKCk7CiAgfQoKICBvcGVuU2lnbnVwKCkgewogICAgKHRoaXMuJHJlZnNbInNpZ251cCJdIGFzIGFueSkuc2hvd01vZGFsKCk7CiAgfQogIG9uTG9naW4oKSB7CiAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IG5hbWU6ICJkYXNoYm9hcmQiIH0pOwogIH0KICBpbnB1dENoYW5nZSgpIHsKICAgIGNvbnNvbGUubG9nKCJoZXJlIik7CiAgfQogIG9uU2lnbnVwKCkgewogICAgdGhpcy4kcm91dGVyLnB1c2goeyBuYW1lOiAicHJvZmlsZSIgfSk7CiAgfQogIHdyaXRlUmV2aWV3KCkgewogICAgaWYgKHRoaXMudXNlcikgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IG5hbWU6ICJkYXNoYm9hcmQiIH0pOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5vcGVuTG9naW4oKTsKICAgIH0KICB9Cn0K"},{"version":3,"sources":["Header.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Header.vue","sourceRoot":"src/layouts/dashboard/Header","sourcesContent":["<template>\n  <div class=\"dashboard-header\" :class=\"openedMenu ? 'header__toggle-opened' : ''\">\n    <b-navbar sticky toggleable=\"lg\" type=\"light\" variant=\"light\">\n      <b-navbar-brand @click=\"goHome\" href=\"javascript:;\">\n        <img src=\"@/assets/images/logo_black.svg\" alt=\"\">\n      </b-navbar-brand>\n      <button v-on:click=\"writeReview()\" type=\"button\" class=\"btn btn-outline-primary header__write-review-button-home\">Write a Review</button>\n      <b-navbar-toggle target=\"nav-collapse\" class=\"btn btn-link ml-auto header__toggle\" @click=\"openMenu\">\n        <font-awesome-icon :icon=\"['fal', 'bars']\" />\n      </b-navbar-toggle>\n\n      <b-collapse id=\"nav-collapse\" is-nav>\n        <!-- Right aligned nav items -->\n        <b-navbar-nav class=\"ml-auto\">\n          <li class=\"mr-lg-5\">\n          <div class=\"form-inline search-place-form search-place-form-header mb-3 mb-md-0\">\n            <div class=\"row no-gutters\" :class=\"!showSearchBar ?'d-none': ''\">\n              <div class=\"col\">\n                  <div class=\"form-inline search-place-form\">\n                    <div class=\"row no-gutters w-100\">\n                      <div class=\"col search-place-form__input\">\n                        <div class=\"input-group\">\n                          <vue-google-autocomplete\n\n                              id=\"searchBar\"\n                              class=\"form-control\"\n                              placeholder=\"Find a place...\"\n                              v-bind:enable-geolocation=\"true\"\n                              types=\"establishment\"\n                              v-on:placechanged=\"findPlaceChanged\"\n                              v-on:blur=\"showTooltip\"\n                              v-on:focus=\"hideTooltip\"\n                          >\n                          </vue-google-autocomplete>\n                        </div>\n                      </div>\n                      <div class=\"col-auto search-place-form__button\">\n                        <button\n                          class=\"btn btn-transparent header-search__button\" type=\"button\">\n                          <font-awesome-icon :icon=\"['far', 'search']\" />\n                        </button>\n                      </div>\n                    </div>\n                  </div>\n\n                <!--<input type=\"text\" class=\"form-control\" placeholder=\"places...\">-->\n                \n              </div>\n            </div>\n          </div>\n          </li>\n          <b-nav-item class=\"mb-3 mb-md-0\">\n            <button  :class=\"!showSearchBar ?'d-none': ''\" v-on:click=\"getRoutePath('dashboard')\" type=\"button\" class=\"btn btn-outline-primary header__write-review-button\">Write a Review</button>\n          </b-nav-item>\n          <b-nav-item-dropdown right class=\"notifications-nav\" v-show=\"user\" no-caret>\n            <template #button-content>\n              <div class=\"notification-icon\"   v-if=\"notifications.length > 0\">\n                <img src=\"@/assets/images/bell.svg\" alt=\"Title\">\n                <span class=\"notification-count\" v-if=\"notifications.length > 0\" v-text=\"notifications.length\"></span>\n              </div>\n            </template>\n            <b-dropdown-item v-for=\"(notification,index) in notifications\" :key=\"index\" href=\"javascript:;\">\n              <span v-text=\"notification\"></span>\n            </b-dropdown-item>\n          </b-nav-item-dropdown>\n          <b-nav-item-dropdown right class=\"profile-nav\" v-if=\"user\">\n            <template #button-content>\n              <b class=\"username\">{{ user.firstName + \" \" + user.lastName }}</b>\n              <div v-if=\"user.profilePhoto.url == ''\" class=\"profile-photo\">\n                <img src=\"@/assets/images/person.png\" alt=\"\">\n              </div>\n              <div v-else class=\"profile-photo\">\n                <img :src=\"user.profilePhoto.url\" :alt=\"user.firstName\">\n              </div>\n              <div class=\"caret\">\n                <font-awesome-icon :icon=\"['far', 'chevron-down']\" />\n              </div>\n            </template>\n            <b-dropdown-item v-on:click=\"getRoutePath('profile',{'id':user.id})\" href=\"javascript:;\" class=\"profile-link\">\n              <img class=\"icon\" src=\"@/assets/images/person_icon.svg\" alt=\"Person\">My Profile\n            </b-dropdown-item>\n            <div class=\"divider\"></div>\n            <b-dropdown-item href=\"javascript:;\" class=\"logout-link\" @click=\"logout\">Log out</b-dropdown-item>\n          </b-nav-item-dropdown>\n          <button type=\"button\" class=\"btn btn-outline-primary\" id=\"header-signup-button\" @click=\"openSignup()\" v-show=\"!user\">Sign up</button>\n          <button type=\"button\" @click=\"openLogin()\" class=\"btn btn-primary ml-3\" v-show=\"!user\">Login</button>\n          <!-- <button ref=\"logout\" class=\"btn btn-outline-primary \" @click=\"logout\" v-show=\"user\">Logout</button> -->\n        </b-navbar-nav>\n      </b-collapse>\n\n    </b-navbar>\n    <Login ref=\"login\" @onLogin=\"onLogin\" @openSignup=\"openSignup\"></Login>\n    <signup ref=\"signup\" @onSignup=\"onSignup\"></signup>\n  </div>\n</template>\n\n<style lang=\"scss\" src=\"./Header.scss\"/>\n<script lang=\"ts\">\nimport {Vue, Component, Inject} from 'vue-property-decorator';\nimport {UserService} from \"@/services/UserService\";\nimport {IUser} from \"@/interfaces/IUser\";\nimport {NotificationsService} from \"@/services/NotficationsService\";\nimport VueGoogleAutocomplete from \"vue-google-autocomplete\";\nimport Login from \"@/components/Login/Login.vue\";\nimport Signup from \"@/components/Signup/Signup.vue\";\n\n@Component({\n  components: {\n    VueGoogleAutocomplete,\n    Login,\n    Signup,\n  }\n})\nexport default class Header extends Vue{\n  @Inject('userService')\n  user_ser!: UserService;\n\n  @Inject('notificationsService')\n  notification_service!: NotificationsService;\n  notifications: [] | null;\n  user: IUser|null = null;\n  showSearchBar: boolean;\n  tooltip = true;\n  place: any | null = null;\n  openedMenu = false;\n  constructor() {\n    super();\n    this.notifications=[];\n    this.showSearchBar= true;\n    /*if(this.$route.name=='landing'){\n      this.showSearchBar= false;\n    }*/\n  }\n\n  async mounted(){\n    if (this.$route.query.token != null && this.$route.query.username != null) {\n      const tokenObj = {\n        username: this.$route.query.username,\n        token: this.$route.query.token,\n        expires_at: this.$route.query.expires_at\n      }\n      localStorage.setItem('token', JSON.stringify(tokenObj))\n      await this.user_ser.updateUserLocalStorage(this.$route.query.username as string)\n      const query = Object.assign({}, this.$route.query);\n      delete query.token;\n      delete query.expires_at;\n      delete query.username;\n      this.$router.replace({ query });\n      window.location.reload()\n    }\n    const user = this.user_ser.getCurrentUser();\n    if(user){\n      this.user = user;\n      // Weird hack for handcash since we don't have lastname all the time\n      if (this.user.lastName == null) {\n        this.user.lastName = \"\"\n      }\n      const x= await this.notification_service.getUserNotifications();\n      if(x.status==200){\n       this.notifications=x.data.notifications;\n      }\n    }\n  }\n\n  goHome() {\n    this.$router.push({name: \"home\"});\n  }\n  getAddressData() {\n    console.log('h')\n  }\n  getRoutePath(name: string,parameters: any){\n    return this.$router.push({name: name, params: parameters});\n  }\n  async logout(){\n    await this.user_ser.logout();\n    if(this.$route.name=='home') {\n      location.reload();\n    } else {\n      this.$router.push({name: \"home\"});\n    }\n  }\n  findPlaceChanged(ret: any, place: any, id: any) {\n    this.place = place;\n    if (typeof place.place_id != \"undefined\") {\n      this.getRoutePath(\"place\", { id: place.place_id });\n      if(this.$route.name=='place'){\n        location.reload();\n      }\n    }\n  }\n  hideTooltip() {\n    this.tooltip = false;\n  }\n  showTooltip() {\n    this.tooltip = true;\n  }\n  openMenu(){\n    this.openedMenu = !this.openedMenu;\n  }\n\n\n  openLogin() {\n    (this.$refs[\"login\"] as any).showModal();\n  }\n\n  openSignup() {\n    (this.$refs[\"signup\"] as any).showModal();\n  }\n  onLogin() {\n    this.$router.push({ name: \"dashboard\" });\n  }\n  inputChange() {\n    console.log(\"here\");\n  }\n  onSignup() {\n    this.$router.push({ name: \"profile\" });\n  }\n  writeReview() {\n    if (this.user) {\n      this.$router.push({ name: \"dashboard\" });\n    } else {\n      this.openLogin();\n    }\n  }\n}\n</script>\n"]}]}