{"remainingRequest":"/home/cmurray/britevue-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/cmurray/britevue-frontend/src/components/Signup/Signup.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/home/cmurray/britevue-frontend/src/components/Signup/Signup.vue","mtime":1628691920056},{"path":"/home/cmurray/britevue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/cmurray/britevue-frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/cmurray/britevue-frontend/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/home/cmurray/britevue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/cmurray/britevue-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKY29uc3QgSGFuZGNhc2hBcHBJRCA9IHByb2Nlc3MuZW52LlZVRV9BUFBfSENfQVBQX0lECmltcG9ydCB7IFZ1ZSwgQ29tcG9uZW50LCBJbmplY3R9IGZyb20gJ3Z1ZS1wcm9wZXJ0eS1kZWNvcmF0b3InOwppbXBvcnQgIi4vU2lnbnVwLnNjc3MiOwppbXBvcnQge0lOZXdVc2VyfSBmcm9tICJAL2ludGVyZmFjZXMvSU5ld1VzZXIiOwppbXBvcnQge1VzZXJTZXJ2aWNlfSBmcm9tICJAL3NlcnZpY2VzL1VzZXJTZXJ2aWNlIjsKCkBDb21wb25lbnQKZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2lnbnVwIGV4dGVuZHMgVnVlIHsKICB1c2VyOiBJTmV3VXNlcgoKICBASW5qZWN0KCd1c2VyU2VydmljZScpCiAgdXNlcl9zZXIhOiBVc2VyU2VydmljZTsKICBsb2FkaW5nID0gZmFsc2U7CiAgZXJyb3JfbWVzc2FnZTogc3RyaW5nOwogIG9wZW46IGJvb2xlYW47CgogIGNvbnN0cnVjdG9yKCkgewogICAgc3VwZXIoKTsKICAgIHRoaXMub3BlbiA9IGZhbHNlOwogICAgdGhpcy5lcnJvcl9tZXNzYWdlID0gIiI7CiAgICB0aGlzLnVzZXIgPSB7CiAgICAgIGlkOiAiIiwKICAgICAgZW1haWw6ICIiLAogICAgICBmaXJzdE5hbWU6ICIiLAogICAgICBsYXN0TmFtZTogIiIsCiAgICAgIHBhc3N3b3JkOiAiIiwKICAgICAgY29uZmlybVBhc3N3b3JkOiAiIiwKICAgICAgYWN0aXZlOiB0cnVlLAogICAgfTsKICB9CiAgaXNPcGVuKCkgewogICAgcmV0dXJuIHRoaXMub3BlbgogIH0KICBzaG93TW9kYWwoKXsKICAgIHRoaXMub3BlbiA9IHRydWU7CiAgICB0aGlzLiRidk1vZGFsLnNob3coInNpZ251cC1tb2RhbCIpOwogIH0KICBhc3luYyBzaWdudXBIYW5kY2FzaCgpIHsKICAgIGNvbnN0IGV4cGlyZUluID0gbmV3IERhdGUobmV3IERhdGUoKS5nZXRUaW1lKCkgKyA1ICogNjAgKiAxMDAwKTsKICAgIHRoaXMuJGNvb2tpZXMuc2V0KCdzaWdudXBVc2VyJywgdHJ1ZSwgZXhwaXJlSW4pCiAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICdodHRwczovL2FwcC5oYW5kY2FzaC5pby8jL2F1dGhvcml6ZUFwcD9hcHBJZD0nICsgSGFuZGNhc2hBcHBJRAogIH0KCiAgYXN5bmMgc2lnbnVwKCl7CiAgICB0aGlzLmVycm9yX21lc3NhZ2UgPSAiIgogICAgaWYgKHRoaXMudXNlci5maXJzdE5hbWUgPT0gIiIgfHwgdGhpcy51c2VyLmxhc3ROYW1lID09ICIiKSB7CiAgICAgIHRoaXMuZXJyb3JfbWVzc2FnZSA9ICJQbGVhc2Ugc3VwcGx5IHlvdXIgZmlyc3QgYW5kIGxhc3QgbmFtZSIKICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAodGhpcy51c2VyLmlkID09ICIiKSB7CiAgICAgIHRoaXMuZXJyb3JfbWVzc2FnZSA9ICJQbGVhc2UgcGljayBhIHVzZXJuYW1lIgogICAgICByZXR1cm4KICAgIH0KICAgIGlmICghL14oW2EtejAtOV17NSx9KSQvLnRlc3QodGhpcy51c2VyLmlkKSkgewogICAgICB0aGlzLmVycm9yX21lc3NhZ2U9ICJVc2VybmFtZSBtdXN0IGJlIGF0IGxlYXN0IDUgYWxwaGFudW1lcmljIGNoYXJhY3RlcnMsIGFsbCBsb3dlcmNhc2UiCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAodGhpcy51c2VyLmVtYWlsID09ICIiKSB7CiAgICAgIHRoaXMuZXJyb3JfbWVzc2FnZSA9ICJQbGVhc2Ugc3VwcGx5IHlvdXIgZW1haWwgYWRkcmVzcyIKICAgICAgcmV0dXJuCiAgICB9IGVsc2UgewogICAgICBjb25zdCByZSA9IC9eKChbXjw+KClbXF1cXC4sOzpcc0AiXSsoXC5bXjw+KClbXF1cXC4sOzpcc0AiXSspKil8KCIuKyIpKUAoKFxbWzAtOV17MSwzfVwuWzAtOV17MSwzfVwuWzAtOV17MSwzfVwuWzAtOV17MSwzfVxdKXwoKFthLXpBLVpcLTAtOV0rXC4pK1thLXpBLVpdezIsfSkpJC87CiAgICAgIGlmICghcmUudGVzdCh0aGlzLnVzZXIuZW1haWwpKSB7CiAgICAgICAgdGhpcy5lcnJvcl9tZXNzYWdlID0gIlBsZWFzZSBzdXBwbHkgYSB2YWxpZCBlbWFpbCBhZGRyZXNzIgogICAgICAgIHJldHVybgogICAgICB9CiAgICB9CiAgICBpZiAodGhpcy51c2VyLnBhc3N3b3JkID09ICIiKSB7CiAgICAgIHRoaXMuZXJyb3JfbWVzc2FnZSA9ICJQbGVhc2Ugc3VwcGx5IGEgcGFzc3dvcmQiCiAgICB9CiAgICBpZiAodGhpcy51c2VyLnBhc3N3b3JkICE9PSB0aGlzLnVzZXIuY29uZmlybVBhc3N3b3JkKSB7CiAgICAgIHRoaXMuZXJyb3JfbWVzc2FnZSA9ICJQYXNzd29yZHMgZG8gbm90IG1hdGNoIgogICAgICByZXR1cm4KICAgIH0KICAgIGlmICh0aGlzLnVzZXIucGFzc3dvcmQgJiYgdGhpcy51c2VyLnBhc3N3b3JkLmxlbmd0aCA8IDYpIHsKICAgICAgdGhpcy5lcnJvcl9tZXNzYWdlID0gIlBhc3N3b3JkIG11c3QgYmUgYXQgbGVhc3QgNiBjaGFyYWN0ZXJzIGxvbmciCiAgICAgIHJldHVybgogICAgfQogICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgIGxldCBlcnIgPSBudWxsOwogICAgYXdhaXQgdGhpcy51c2VyX3Nlci5zaWdudXAodGhpcy51c2VyKS5jYXRjaChlID0+IGVyciA9IGUpOwogICAgaWYoIWVycil7CiAgICAgIGF3YWl0IHRoaXMudXNlcl9zZXIubG9naW4odGhpcy51c2VyLmlkLCB0aGlzLnVzZXIucGFzc3dvcmQhKS5jYXRjaChlID0+IGVyciA9IGUpOwogICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgaWYoIWVycil7CiAgICAgICAgdGhpcy4kYnZNb2RhbC5oaWRlKCJzaWdudXAtbW9kYWwiKTsKICAgICAgICB0aGlzLm9wZW4gPSBmYWxzZTsKICAgICAgICB0aGlzLiRlbWl0KCdvblNpZ251cCcsIHRydWUpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aGlzLmVycm9yX21lc3NhZ2UgPSAidXNlcm5hbWUgaGFzIGFscmVhZHkgYmVlbiB0YWtlbiwgcGxlYXNlIHNlbGVjdCBhIG5ldyBvbmUiCiAgICB9CiAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICB9Cn0K"},{"version":3,"sources":["Signup.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Signup.vue","sourceRoot":"src/components/Signup","sourcesContent":["<template>\n  <b-modal id=\"signup-modal\" title=\"Sign up to Britevue\" size=\"lg\" centered>\n    <template #modal-header=\"{close}\">\n      <button type=\"button\" class=\"close\" aria-label=\"Close\" @click=\"close\">\n        <span aria-hidden=\"true\">&times;</span>\n      </button>\n      <b-container fluid>\n        <!-- Emulate built in modal header close button action -->\n        <b-row class=\"no-gutters\">\n          <b-col cols=\"12\" class=\"text-center mb-4\">\n            <h4 class=\"modal-title\">Sign up to Britevue</h4>\n          </b-col>\n        </b-row>\n      </b-container>\n    </template>\n    <b-container fluid>\n      <b-row class=\"signup-input\">\n        <div class=\"col-12\">\n          <div class=\"row name-con\">\n            <div class=\"col-6\">\n              <b-form-input v-model=\"user.firstName\" placeholder=\"First Name\" :class=\"''\"></b-form-input>\n            </div>\n            <div class=\"col-6\">\n              <b-form-input v-model=\"user.lastName\" placeholder=\"Last Name\" :class=\"''\"></b-form-input>\n            </div>\n          </div>\n        </div>\n        <b-col cols=\"12\">\n          <b-form-input v-model=\"user.id\" onkeyup=\"this.value = this.value.toLowerCase()\" placeholder=\"Username\"></b-form-input>\n        </b-col>\n        <b-col cols=\"12\">\n          <b-form-input v-model=\"user.email\" placeholder=\"Email\"></b-form-input>\n        </b-col>\n        <b-col cols=\"12\">\n          <b-form-input type=\"password\" v-model=\"user.password\" placeholder=\"Password\"></b-form-input>\n        </b-col>\n        <b-col cols=\"12\">\n          <b-form-input type=\"password\" v-model=\"user.confirmPassword\" placeholder=\"Confirm Password\"></b-form-input>\n        </b-col>\n      </b-row>\n    </b-container>\n    <template #modal-footer=\"{  }\">\n      <b-container fluid>\n        <b-row>\n          <b-col cols=\"12\">\n            <p class=\"text-danger\">{{error_message}}</p>\n            <!-- Emulate built in modal footer ok and cancel button actions -->\n            <b-button size=\"lg\" variant=\"primary\" @click=\"signup\" :class=\"loading ?'disabled': ''\" :disabled=\"loading\">\n              Sign Up\n            </b-button>\n          </b-col>\n          <b-col cols=\"12\">\n            <div class=\"singup-text\">\n              <p>Or sign-up with your</p>\n              <div @click=\"signupHandcash\" id=\"connectButtonSignup\">\n                HandCash\n              </div>\n            </div>\n          </b-col>\n        </b-row>\n        <p>By creating an account you agree to our <a href=\"https://britevue.com/terms\" target=\"_blank\" >Terms of Service</a></p>\n      </b-container>\n    </template>\n  </b-modal>\n</template>\n<script lang=\"ts\">\nconst HandcashAppID = process.env.VUE_APP_HC_APP_ID\nimport { Vue, Component, Inject} from 'vue-property-decorator';\nimport \"./Signup.scss\";\nimport {INewUser} from \"@/interfaces/INewUser\";\nimport {UserService} from \"@/services/UserService\";\n\n@Component\nexport default class Signup extends Vue {\n  user: INewUser\n\n  @Inject('userService')\n  user_ser!: UserService;\n  loading = false;\n  error_message: string;\n  open: boolean;\n\n  constructor() {\n    super();\n    this.open = false;\n    this.error_message = \"\";\n    this.user = {\n      id: \"\",\n      email: \"\",\n      firstName: \"\",\n      lastName: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n      active: true,\n    };\n  }\n  isOpen() {\n    return this.open\n  }\n  showModal(){\n    this.open = true;\n    this.$bvModal.show(\"signup-modal\");\n  }\n  async signupHandcash() {\n    const expireIn = new Date(new Date().getTime() + 5 * 60 * 1000);\n    this.$cookies.set('signupUser', true, expireIn)\n    window.location.href = 'https://app.handcash.io/#/authorizeApp?appId=' + HandcashAppID\n  }\n\n  async signup(){\n    this.error_message = \"\"\n    if (this.user.firstName == \"\" || this.user.lastName == \"\") {\n      this.error_message = \"Please supply your first and last name\"\n      return\n    }\n    if (this.user.id == \"\") {\n      this.error_message = \"Please pick a username\"\n      return\n    }\n    if (!/^([a-z0-9]{5,})$/.test(this.user.id)) {\n      this.error_message= \"Username must be at least 5 alphanumeric characters, all lowercase\"\n        return\n    }\n    if (this.user.email == \"\") {\n      this.error_message = \"Please supply your email address\"\n      return\n    } else {\n      const re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n      if (!re.test(this.user.email)) {\n        this.error_message = \"Please supply a valid email address\"\n        return\n      }\n    }\n    if (this.user.password == \"\") {\n      this.error_message = \"Please supply a password\"\n    }\n    if (this.user.password !== this.user.confirmPassword) {\n      this.error_message = \"Passwords do not match\"\n      return\n    }\n    if (this.user.password && this.user.password.length < 6) {\n      this.error_message = \"Password must be at least 6 characters long\"\n      return\n    }\n    this.loading = true;\n    let err = null;\n    await this.user_ser.signup(this.user).catch(e => err = e);\n    if(!err){\n      await this.user_ser.login(this.user.id, this.user.password!).catch(e => err = e);\n      this.loading = false;\n      if(!err){\n        this.$bvModal.hide(\"signup-modal\");\n        this.open = false;\n        this.$emit('onSignup', true);\n      }\n    } else {\n      this.error_message = \"username has already been taken, please select a new one\"\n    }\n    this.loading = false;\n  }\n}\n</script>\n"]}]}