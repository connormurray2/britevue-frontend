{"remainingRequest":"/home/cmurray/britevue-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/cmurray/britevue-frontend/src/views/Dashboard/Place/Place.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/home/cmurray/britevue-frontend/src/views/Dashboard/Place/Place.vue","mtime":1628691920057},{"path":"/home/cmurray/britevue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/cmurray/britevue-frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/cmurray/britevue-frontend/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/home/cmurray/britevue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/cmurray/britevue-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCmltcG9ydCB7Q29tcG9uZW50LCBJbmplY3QsIFZ1ZX0gZnJvbSAidnVlLXByb3BlcnR5LWRlY29yYXRvciI7CmltcG9ydCB7SUdvb2dsZVBsYWNlfSBmcm9tICJAL2ludGVyZmFjZXMvSUdvb2dsZVBsYWNlIjsKaW1wb3J0IHtMb2FkZXIsIExvYWRlck9wdGlvbnN9IGZyb20gImdvb2dsZS1tYXBzIjsKCmltcG9ydCBUaXAgZnJvbSAiQC9jb21wb25lbnRzL1RpcC9UaXAudnVlIjsKaW1wb3J0IHtQbGFjZVNlcnZpY2V9IGZyb20gIkAvc2VydmljZXMvUGxhY2VTZXJ2aWNlIjsKaW1wb3J0IHtSZXZpZXdzU2VydmljZX0gZnJvbSAiQC9zZXJ2aWNlcy9SZXZpZXdzU2VydmljZSI7CmltcG9ydCB7VXNlclNlcnZpY2V9IGZyb20gIkAvc2VydmljZXMvVXNlclNlcnZpY2UiOwppbXBvcnQge0lVc2VyfSBmcm9tICJAL2ludGVyZmFjZXMvSVVzZXIiOwppbXBvcnQge0Zhdm9yaXRlc1NlcnZpY2V9IGZyb20gIkAvc2VydmljZXMvRmF2b3JpdGVzU2VydmljZSI7CmltcG9ydCBMb2dpbiBmcm9tICJAL2NvbXBvbmVudHMvTG9naW4vTG9naW4udnVlIjsKaW1wb3J0IFNpZ251cCBmcm9tICJAL2NvbXBvbmVudHMvU2lnbnVwL1NpZ251cC52dWUiOwppbXBvcnQgTW9kYWwgZnJvbSAiQC9jb21wb25lbnRzL01vZGFsL01vZGFsLnZ1ZSI7CmltcG9ydCBJbWFnZU1vZGFsIGZyb20gIkAvY29tcG9uZW50cy9JbWFnZU1vZGFsL0ltYWdlTW9kYWwudnVlIjsKaW1wb3J0IFJldmlld0ltYWdlTW9kYWwgZnJvbSAgIkAvY29tcG9uZW50cy9JbWFnZU1vZGFsL1Jldmlld0ltYWdlTW9kYWwudnVlIjsKCkBDb21wb25lbnQoewogIGNvbXBvbmVudHM6IHsKICAgIExvZ2luLAogICAgU2lnbnVwLAogICAgVGlwLAogICAgTW9kYWwsCiAgICBJbWFnZU1vZGFsLAogICAgUmV2aWV3SW1hZ2VNb2RhbAogIH0sCiAgbWV0YUluZm86ewogICAgdGl0bGU6ICJCcml0ZXZ1ZSAtIEJsb2NrY2hhaW4gdmVyaWZpZWQgcmV2aWV3cyB3aGVyZSByZXZpZXdlcnMgZ2V0IHBhaWQiLAogICAgbWV0YTogWwogICAgICB7IG5hbWU6J3RpdGxlJyxjb250ZW50OidCcml0ZXZ1ZSAtIEJsb2NrY2hhaW4gdmVyaWZpZWQgcmV2aWV3cyB3aGVyZSByZXZpZXdlcnMgZ2V0IHBhaWQnfSwKICAgICAgeyBuYW1lOiAnZGVzY3JpcHRpb24nLCBjb250ZW50OiAgJ0JlZ2luIGVhcm5pbmcgbW9uZXkgZm9yIHlvdXIgcmV2aWV3cyBvZiBidXNpbmVzc2VzIGFuZCBwbGFjZXMgd2l0aCBCcml0ZXZ1ZS4gV2Ugd2lsbCBwYXkgeW91IGZvciBpbmZvcm1hdGlvbiBhYm91dCB5b3VyIGhvbWV0b3duIHRvIGdldCBzdGFydGVkISd9LAogICAgICB7IGl0ZW1wcm9wOiAnbmFtZScsIGNvbnRlbnQ6ICJCcml0ZXZ1ZSJ9LAogICAgICB7IGl0ZW1wcm9wOiAnZGVzY3JpcHRpb24nLCBjb250ZW50OiAiQmVnaW4gZWFybmluZyBtb25leSBmb3IgeW91ciByZXZpZXdzIG9mIGJ1c2luZXNzZXMgYW5kIHBsYWNlcyB3aXRoIEJyaXRldnVlLiBXZSB3aWxsIHBheSB5b3UgZm9yIGluZm9ybWF0aW9uIGFib3V0IHlvdXIgaG9tZXRvd24gdG8gZ2V0IHN0YXJ0ZWQhIn0sCiAgICAgIHsgaXRlbXByb3A6ICdpbWFnZScsIGNvbnRlbnQ6ICByZXF1aXJlKCdAL2Fzc2V0cy9pbWFnZXMvbG9nb19ibGFjay5zdmcnKX0sCiAgICAgIHsgcHJvcGVydHk6ICdvZzp0eXBlJywgY29udGVudDogIndlYnNpdGUifSwKICAgICAgeyBwcm9wZXJ0eTogJ29nOnVybCcsIGNvbnRlbnQ6ICJodHRwczovL2JyaXRldnVlLmNvbS8ifSwKICAgICAgeyBwcm9wZXJ0eTogJ29nOnRpdGxlJywgY29udGVudDogIkJyaXRldnVlIC0gQmxvY2tjaGFpbiB2ZXJpZmllZCByZXZpZXdzIHdoZXJlIHJldmlld2VycyBnZXQgcGFpZCJ9LAogICAgICB7IHByb3BlcnR5OiAnb2c6ZGVzY3JpcHRpb24nLCBjb250ZW50OiAiQmVnaW4gZWFybmluZyBtb25leSBmb3IgeW91ciByZXZpZXdzIG9mIGJ1c2luZXNzZXMgYW5kIHBsYWNlcyB3aXRoIEJyaXRldnVlLiBXZSB3aWxsIHBheSB5b3UgZm9yIGluZm9ybWF0aW9uIGFib3V0IHlvdXIgaG9tZXRvd24gdG8gZ2V0IHN0YXJ0ZWQhIn0sCiAgICAgIHsgcHJvcGVydHk6ICdvZzppbWFnZScsIGNvbnRlbnQ6ICByZXF1aXJlKCdAL2Fzc2V0cy9pbWFnZXMvbG9nb19ibGFjay5zdmcnKX0sCiAgICAgIHsgcHJvcGVydHk6ICdvZzpzaXRlX25hbWUnLCBjb250ZW50OiAnYnJpdGV2dWUnfSwKICAgICAgeyBuYW1lOiAndHdpdHRlcjpjYXJkJywgY29udGVudDogInN1bW1hcnlfbGFyZ2VfaW1hZ2UifSwKICAgICAgeyBuYW1lOiAndHdpdHRlcjp1cmwnLCBjb250ZW50OiAiaHR0cHM6Ly9icml0ZXZ1ZS5jb20vIn0sCiAgICAgIHsgbmFtZTogJ3R3aXR0ZXI6dGl0bGUnLCBjb250ZW50OiAiQnJpdGV2dWUgLSBCbG9ja2NoYWluIHZlcmlmaWVkIHJldmlld3Mgd2hlcmUgcmV2aWV3ZXJzIGdldCBwYWlkIn0sCiAgICAgIHsgbmFtZTogJ3R3aXR0ZXI6ZGVzY3JpcHRpb24nLCBjb250ZW50OiAiQmVnaW4gZWFybmluZyBtb25leSBmb3IgeW91ciByZXZpZXdzIG9mIGJ1c2luZXNzZXMgYW5kIHBsYWNlcyB3aXRoIEJyaXRldnVlLiBXZSB3aWxsIHBheSB5b3UgZm9yIGluZm9ybWF0aW9uIGFib3V0IHlvdXIgaG9tZXRvd24gdG8gZ2V0IHN0YXJ0ZWQhIn0sCiAgICAgIHsgbmFtZTogJ3R3aXR0ZXI6aW1hZ2UnLCBjb250ZW50OiByZXF1aXJlKCdAL2Fzc2V0cy9pbWFnZXMvbG9nb19ibGFjay5zdmcnKSB9LAogICAgXQogIH0KfSkKZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGxhY2UgZXh0ZW5kcyBWdWUgewogIHBsYWNlX2lkOiBzdHJpbmc7CiAgcGxhY2U6IElHb29nbGVQbGFjZSB8IG51bGw7CgogIEBJbmplY3QoJ2Zhdm9yaXRlc1NlcnZpY2UnKQogIGZhdm9yaXRlc19zZXIhOiBGYXZvcml0ZXNTZXJ2aWNlOwoKICBASW5qZWN0KCdwbGFjZVNlcnZpY2UnKQogIHBsYWNlX3NlciE6IFBsYWNlU2VydmljZTsKCiAgQEluamVjdCgncmV2aWV3c1NlcnZpY2UnKQogIHJldmlld3Nfc2VyITogUmV2aWV3c1NlcnZpY2U7CiAgcmV2aWV3cyA9IFtdOwogIHNob3dSZXZpZXdzOiBudW1iZXI7CiAgQEluamVjdCgndXNlclNlcnZpY2UnKQogIHVzZXJfc2VydmljZSE6IFVzZXJTZXJ2aWNlOwogIHByb2ZpbGU6IElVc2VyIHwgbnVsbCA9IG51bGw7CiAgZmlsZXM6IEZpbGVbXSA9IFtdOwogIHN0ZXA6IG51bWJlcjsKICB1cGxvYWRQcm9ncmVzczogbnVtYmVyOwogIHNob3dVcGxvYWRQcm9ncmVzc0JhcjogYm9vbGVhbjsKICBvcHRpb25zOiBhbnk7CiAgZmxhc2g6IGFueTsKICB0aXBTdGF0dXM6IGJvb2xlYW47CiAgbG9hZGluZ1Jldmlld3M6IGJvb2xlYW47CiAgbG9hZGluZ1BsYWNlOiBib29sZWFuOwogIGlzRmF2b3JpdGU6IGJvb2xlYW47CiAgc2hvd0hhbmRjYXNoTW9kYWw6IGJvb2xlYW47CiAgc2hvd0dvb2dsZUltYWdlTW9kYWw6IGJvb2xlYW47CiAgc2hvd0JyaXRldnVlSW1hZ2VNb2RhbDogYm9vbGVhbjsKICBtYWluSW1hZ2VNb2RlbDogc3RyaW5nOwogIG1haW5JbWFnZUluZGV4OiBudW1iZXI7CiAgcmV2aWV3UGhvdG9zOiBbXTsKICBzaG93UmV2aWV3SW1hZ2VNb2RhbDogYm9vbGVhbjsKICBtYWluUmV2aWV3SW1hZ2VNb2RlbDogc3RyaW5nOwoKCiAgY29uc3RydWN0b3IoKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy5wbGFjZV9pZCA9ICcnOwogICAgdGhpcy5zaG93UmV2aWV3cyA9IDY7CiAgICBpZiAodHlwZW9mIHRoaXMuJHJvdXRlLnBhcmFtcy5pZCAhPSAndW5kZWZpbmVkJykgewogICAgICB0aGlzLnBsYWNlX2lkID0gdGhpcy4kcm91dGUucGFyYW1zLmlkOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goe25hbWU6ICJkYXNoYm9hcmQifSk7CiAgICB9CiAgICB0aGlzLnBsYWNlID0gbnVsbDsKICAgIHRoaXMuc3RlcCA9IDA7CiAgICB0aGlzLnVwbG9hZFByb2dyZXNzID0gMDsKICAgIHRoaXMuc2hvd1VwbG9hZFByb2dyZXNzQmFyID0gZmFsc2U7CiAgICB0aGlzLmxvYWRpbmdSZXZpZXdzID0gdHJ1ZTsKICAgIHRoaXMubG9hZGluZ1BsYWNlID0gdHJ1ZQogICAgdGhpcy5vcHRpb25zID0gewogICAgICB0ZXh0OiB7CiAgICAgICAgY29sb3I6ICcjRkZGRkZGJywKICAgICAgICBzaGFkb3dFbmFibGU6IHRydWUsCiAgICAgICAgc2hhZG93Q29sb3I6ICcjMDAwMDAwJywKICAgICAgICBmb250U2l6ZTogMTQsCiAgICAgICAgZm9udEZhbWlseTogJ0hlbHZldGljYScsCiAgICAgICAgZHluYW1pY1Bvc2l0aW9uOiBmYWxzZSwKICAgICAgICBoaWRlVGV4dDogZmFsc2UKICAgICAgfSwKICAgICAgcHJvZ3Jlc3M6IHsKICAgICAgICBjb2xvcjogJyNjYzdhMDAnLAogICAgICAgIGJhY2tncm91bmRDb2xvcjogJyMzMzMzMzMnCiAgICAgIH0sCiAgICAgIGxheW91dDogewogICAgICAgIGhlaWdodDogMzUsCiAgICAgICAgd2lkdGg6IDE0MCwKICAgICAgICB2ZXJ0aWNhbFRleHRBbGlnbjogNjEsCiAgICAgICAgaG9yaXpvbnRhbFRleHRBbGlnbjogNDMsCiAgICAgICAgemVyb09mZnNldDogMCwKICAgICAgICBzdHJva2VXaWR0aDogMzAsCiAgICAgICAgcHJvZ3Jlc3NQYWRkaW5nOiAwLAogICAgICAgIHR5cGU6ICdsaW5lJwogICAgICB9CiAgICB9CgogICAgdGhpcy51c2VyX3NlcnZpY2UudXBkYXRlVXNlckxvY2FsU3RvcmFnZSgiIikKICAgIGNvbnN0IHVzZXIgPSB0aGlzLnVzZXJfc2VydmljZS5nZXRDdXJyZW50VXNlcigpOwogICAgaWYgKHVzZXIpIHsKICAgICAgdGhpcy5wcm9maWxlID0gdXNlcjsKICAgICAgLy9jaGVjayB1c2VyIHRva2VuIGlzIGV4cGlyZWQKICAgICAgY29uc3QgY2hlY2tVc2VyID0gdGhpcy51c2VyX3NlcnZpY2UuZ2V0VXNlcih0aGlzLnByb2ZpbGUuaWQpOwogICAgfQogICAgdGhpcy50aXBTdGF0dXM9ZmFsc2U7CiAgICB0aGlzLmlzRmF2b3JpdGU9ZmFsc2U7CiAgICB0aGlzLnNob3dIYW5kY2FzaE1vZGFsPWZhbHNlOwogICAgdGhpcy5zaG93R29vZ2xlSW1hZ2VNb2RhbD1mYWxzZTsKICAgIHRoaXMuc2hvd0JyaXRldnVlSW1hZ2VNb2RhbD1mYWxzZTsKICAgIHRoaXMubWFpbkltYWdlTW9kZWw9ICcnOwogICAgdGhpcy5tYWluSW1hZ2VJbmRleD0wOwogICAgdGhpcy5yZXZpZXdQaG90b3M9W107CiAgICB0aGlzLnNob3dSZXZpZXdJbWFnZU1vZGFsPWZhbHNlOwogICAgdGhpcy5tYWluUmV2aWV3SW1hZ2VNb2RlbD0nJzsKICB9CgoKICBhc3luYyBtb3VudGVkKCkgewogICAgaWYgKHRoaXMuJHJvdXRlLnF1ZXJ5LnRva2VuICE9IG51bGwgJiYgdGhpcy4kcm91dGUucXVlcnkudXNlcm5hbWUgIT0gbnVsbCkgewogICAgICBjb25zdCB0b2tlbk9iaiA9IHsKICAgICAgICB1c2VybmFtZTogdGhpcy4kcm91dGUucXVlcnkudXNlcm5hbWUsCiAgICAgICAgdG9rZW46IHRoaXMuJHJvdXRlLnF1ZXJ5LnRva2VuLAogICAgICAgIGV4cGlyZXNfYXQ6IHRoaXMuJHJvdXRlLnF1ZXJ5LmV4cGlyZXNfYXQKICAgICAgfQogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndG9rZW4nLCBKU09OLnN0cmluZ2lmeSh0b2tlbk9iaikpCiAgICAgIGF3YWl0IHRoaXMudXNlcl9zZXJ2aWNlLnVwZGF0ZVVzZXJMb2NhbFN0b3JhZ2UodGhpcy4kcm91dGUucXVlcnkudXNlcm5hbWUgYXMgc3RyaW5nKQogICAgfSBlbHNlIHsKICAgICAgYXdhaXQgdGhpcy51c2VyX3NlcnZpY2UudXBkYXRlVXNlckxvY2FsU3RvcmFnZSgiIik7CiAgICB9CiAgICB0cnkgewogICAgICB0aGlzLmxvYWRpbmdQbGFjZSA9IHRydWUKICAgICAgYXdhaXQgdGhpcy5sb2FkUGxhY2VEZXRhaWwoKTsKICAgICAgYXdhaXQgdGhpcy5sb2FkTWFwKCk7CiAgICAgIHRoaXMubG9hZGluZ1BsYWNlID0gZmFsc2UKICAgICAgYXdhaXQgdGhpcy5sb2FkUmV2aWV3cygpOwogICAgICBhd2FpdCB0aGlzLmNoZWNrUGxhY2VJc0Zhdm9yaXRlKCk7CiAgICB9IGNhdGNoKGUpIHsKICAgICAgdGhpcy5vcGVuTG9naW4oKQogICAgfQogIH0KCiAgYXN5bmMgZGVsZXRlUmV2aWV3KHJldmlld19pZDogc3RyaW5nKSB7CiAgICBpZiAodGhpcy5jaGVja1VzZXJXYWxsZXQoKSkgewogICAgICBpZihjb25maXJtKCdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgcmV2aWV3JykpewogICAgICAgIGNvbnN0IGRlbGV0ZVJldmlldyA9IGF3YWl0IHRoaXMucmV2aWV3c19zZXIuZGVsZXRlUmV2aWV3KHJldmlld19pZCk7CiAgICAgICAgaWYgKGRlbGV0ZVJldmlldy5zdGF0dXMgPT0gMjAwKSB7CiAgICAgICAgICB0aGlzLnJldmlld3MgPSBbXQogICAgICAgICAgdGhpcy5sb2FkUmV2aWV3cygpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZmxhc2goIkhhZCBhIHByb2JsZW0gZGVsZXRpbmcgcmV2aWV3IiwgJ2Vycm9yJywge3RpbWVvdXQ6IDEwMDAwfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogIH0KCiAgYXN5bmMgZWRpdFJldmlldyhwbGFjZV9pZDogc3RyaW5nLCBwbGFjZV9uYW1lOiBzdHJpbmcsIHJldmlld19pZDogc3RyaW5nKSB7CiAgICBpZiAodGhpcy5jaGVja1VzZXJXYWxsZXQoKSkgewogICAgICB0aGlzLmdldFJvdXRlUGF0aCgnbmV3X3JldmlldycsIHsncGxhY2VfaWQnOiBwbGFjZV9pZCwgJ3BsYWNlX25hbWUnOiBwbGFjZV9uYW1lLCAncmV2aWV3X2lkJzogcmV2aWV3X2lkfSk7CiAgICB9CiAgfQoKICBhc3luYyBsb2FkUGxhY2VEZXRhaWwoKSB7CiAgICAvL2NoZWNrIGZpcnN0IGlmIGEgcGxhY2UgaXMgYSBicml0ZS12dWUgcGxhY2UgLCBpZiBub3QgZmV0Y2ggZmV0Y2ggZnJvbSBnb29nbGUKICAgIGNvbnN0IGJyaXRlX3BsYWNlID0gYXdhaXQgdGhpcy5wbGFjZV9zZXIuZ2V0QnJpdGVMb2NhdGlvbih0aGlzLnBsYWNlX2lkKTsKICAgIGlmIChicml0ZV9wbGFjZS5zdGF0dXMgPT0gMjAwKSB7CiAgICAgIHRoaXMucGxhY2UgPSBicml0ZV9wbGFjZS5kYXRhOwogICAgfSBlbHNlIHsKCiAgICAgIGNvbnN0IGdvb2dsZV9wbGFjZSA9IGF3YWl0IHRoaXMucGxhY2Vfc2VyLmdldEdvb2dsZUxvY2F0aW9uKHRoaXMucGxhY2VfaWQpOwogICAgICBpZiAoZ29vZ2xlX3BsYWNlLnN0YXR1cz09MjAwKSB7CiAgICAgICAgdGhpcy5wbGFjZSA9IGdvb2dsZV9wbGFjZS5kYXRhOwogICAgICB9CiAgICAgIGlmKGJyaXRlX3BsYWNlLnN0YXR1cz09NTAwICYmIGdvb2dsZV9wbGFjZS5zdGF0dXM9PTUwMCl7CiAgICAgICAgdGhpcy5mbGFzaCgiUGxhY2UgTm90IEZvdW5kIiwgJ2Vycm9yJywge3RpbWVvdXQ6IDEwMDAwfSk7CiAgICAgIH0KICAgIH0KICB9CgogIGFzeW5jIGxvYWRNYXAoKSB7CiAgICBjb25zdCBvcHRpb25zOiBMb2FkZXJPcHRpb25zID0gey8qIHRvZG8gKi99OwogICAgY29uc3QgbG9hZGVyID0gbmV3IExvYWRlcignQUl6YVN5RE1xckk4aE1xaXlJUGRRVWtSVWVyZG9oeDI4RnV2NHdFJywgb3B0aW9ucyk7CiAgICBjb25zdCBnb29nbGUgPSBhd2FpdCBsb2FkZXIubG9hZCgpOwogICAgLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueSovCiAgICBjb25zdCBjb246IGFueSA9IHRoaXMuJHJlZnMubWFwOwogICAgbGV0IGxhdCA9IC0zNC4zOTc7CiAgICBsZXQgbG5nID0gMTUwLjY0NDsKICAgIGlmICh0aGlzLnBsYWNlICE9IG51bGwgJiYgdGhpcy5wbGFjZS5nZW9tZXRyeSAhPSBudWxsICYmIHRoaXMucGxhY2UuZ2VvbWV0cnkubG9jYXRpb24gIT0gbnVsbCkgewogICAgICBsYXQgPSB0aGlzLnBsYWNlLmdlb21ldHJ5LmxvY2F0aW9uLmxhdAogICAgICBsbmcgPSB0aGlzLnBsYWNlLmdlb21ldHJ5LmxvY2F0aW9uLmxuZwogICAgfQogICAgLy9sb2FkIG1hcAogICAgbmV3IGdvb2dsZS5tYXBzLk1hcChjb24sIHsKICAgICAgY2VudGVyOiB7bGF0OiBsYXQsIGxuZzogbG5nfSwKICAgICAgem9vbTogMTUsCiAgICB9KTsKICB9CgogIHRpcChhbW91bnQ6IHN0cmluZykgewogICAgY29uc29sZS5sb2coJ3RpcHBpbmc6JywgYW1vdW50KTsKICB9CgogIGdvVG9QaG90b3MoKSB7CiAgICB0aGlzLmdldFJvdXRlUGF0aCgncGxhY2VfcGhvdG9zJywgeydwbGFjZSc6IHRoaXMucGxhY2V9KTsKICB9CgogIGFzeW5jIGxvYWRSZXZpZXdzKCkgewogICAgdGhpcy5sb2FkaW5nUmV2aWV3cyA9IHRydWUKICAgIGxldCByZXZpZXdzID0gYXdhaXQgdGhpcy5yZXZpZXdzX3Nlci5nZXRQbGFjZVJldmlld3ModGhpcy5wbGFjZV9pZCk7CiAgICBpZiAocmV2aWV3cy5zdGF0dXM9PTIwMCkgewogICAgICByZXZpZXdzPXJldmlld3MuZGF0YTsKICAgICAgbGV0IGk7CiAgICAgIGZvcihpPTA7aTxyZXZpZXdzLmxlbmd0aDtpKyspewogICAgICAgIGNvbnN0IHVzZXJJbmZvPWF3YWl0IHRoaXMudXNlcl9zZXJ2aWNlLmdldFVzZXIocmV2aWV3c1tpXS51c2VyKTsKICAgICAgICBpZiAodXNlckluZm8uc3RhdHVzPT0yMDApIHsKICAgICAgICAgIHJldmlld3NbaV0udXNlckluZm89dXNlckluZm8uZGF0YTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdGhpcy5yZXZpZXdzID0gcmV2aWV3czsKICAgIH0KICAgIHRoaXMubG9hZGluZ1Jldmlld3MgPSBmYWxzZQogIH0KCiAgY2xvc2luZ1RpbWUoKSB7CiAgICBjb25zdCBkdCA9IG5ldyBEYXRlKCk7CiAgICBjb25zdCBkYXlPZlRoZVdlZWsgPSBkdC5nZXREYXkoKTsKICAgIGlmICh0aGlzLnBsYWNlID09IG51bGwgfHwgdGhpcy5wbGFjZS5vcGVuaW5nX2hvdXJzID09IG51bGwgfHwgdGhpcy5wbGFjZS5vcGVuaW5nX2hvdXJzLnBlcmlvZHMgPT0gbnVsbCkgewogICAgICByZXR1cm4gJycKICAgIH0KICAgIGxldCBob3VyczsKICAgIGxldCBtaW51dGVzOwogICAgbGV0IHNoaWZ0OwogICAgaWYodGhpcy5wbGFjZS5vcGVuaW5nX2hvdXJzLm9wZW5fbm93PT10cnVlKXsKICAgICAgaWYodGhpcy5wbGFjZS5vcGVuaW5nX2hvdXJzLnBlcmlvZHMubGVuZ3RoPT03KXsKICAgICAgICBpZih0eXBlb2YgdGhpcy5wbGFjZS5vcGVuaW5nX2hvdXJzLnBlcmlvZHNbZGF5T2ZUaGVXZWVrXS5jbG9zZS50aW1lIT0ndW5kZWZpbmVkJyl7CiAgICAgICAgICBob3Vycz10aGlzLnBsYWNlLm9wZW5pbmdfaG91cnMucGVyaW9kc1tkYXlPZlRoZVdlZWtdLmNsb3NlLnRpbWUuc3Vic3RyaW5nKDAsMik7CiAgICAgICAgICBtaW51dGVzPXRoaXMucGxhY2Uub3BlbmluZ19ob3Vycy5wZXJpb2RzW2RheU9mVGhlV2Vla10uY2xvc2UudGltZS5zdWJzdHJpbmcoMiw0KTsKICAgICAgICAgIHNoaWZ0PSdBTSc7CiAgICAgICAgICBpZihob3VycyA+IDEyKXsKICAgICAgICAgICAgaG91cnMtPTEyOwogICAgICAgICAgICBzaGlmdD0nUE0nOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIGhvdXJzKyc6JyttaW51dGVzKycgJytzaGlmdDsKICAgICAgICB9CiAgICAgIH1lbHNlIGlmKHRoaXMucGxhY2Uub3BlbmluZ19ob3Vycy5wZXJpb2RzLmNvdW50PT0xKXsKICAgICAgICBpZih0eXBlb2YgdGhpcy5wbGFjZS5vcGVuaW5nX2hvdXJzLnBlcmlvZHNbMF0uY2xvc2UudGltZSE9J3VuZGVmaW5lZCcpewogICAgICAgICAgaG91cnM9dGhpcy5wbGFjZS5vcGVuaW5nX2hvdXJzLnBlcmlvZHNbMF0uY2xvc2UudGltZS5zdWJzdHJpbmcoMCwyKTsKICAgICAgICAgIG1pbnV0ZXM9dGhpcy5wbGFjZS5vcGVuaW5nX2hvdXJzLnBlcmlvZHNbMF0uY2xvc2UudGltZS5zdWJzdHJpbmcoMiw0KTsKICAgICAgICAgIHNoaWZ0PSdBTSc7CiAgICAgICAgICBpZihob3VycyA+IDEyKXsKICAgICAgICAgICAgaG91cnMtPTEyOwogICAgICAgICAgICBzaGlmdD0nUE0nOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIGhvdXJzKyc6JyttaW51dGVzKycgJytzaGlmdDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gJyc7CiAgfQoKICBpbWFnZVVybEFsdChldmVudDogYW55KSB7CiAgICBldmVudC50YXJnZXQuc3JjID0gcmVxdWlyZSgnQC9hc3NldHMvaW1hZ2VzL25vLXBob3RvLWF2YXRhci5wbmcnKTsKICB9CgogIGdldFJvdXRlUGF0aChuYW1lOiBzdHJpbmcsIHBhcmFtZXRlcnM6IGFueSkgewoKICAgIHJldHVybiB0aGlzLiRyb3V0ZXIucHVzaCh7bmFtZTogbmFtZSwgcGFyYW1zOiBwYXJhbWV0ZXJzfSk7CiAgfQoKICBzb3J0UmV2aWV3cygpIHsKCiAgICBjb25zdCBzb3J0UmV2aWV3ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NvcnQtcmV2aWV3cycpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7CgogICAgaWYgKHNvcnRSZXZpZXcudmFsdWUgPT0gJ25hbWUnKSB7CiAgICAgIHRoaXMucmV2aWV3cy5zb3J0KChuMTogYW55LCBuMjogYW55KSA9PiB7CiAgICAgICAgaWYgKG4xLnVzZXIgPiBuMi51c2VyKSB7CiAgICAgICAgICByZXR1cm4gMTsKICAgICAgICB9CgogICAgICAgIGlmIChuMS51c2VyIDwgbjIudXNlcikgewogICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIDA7CiAgICAgIH0pOwogICAgfQogICAgaWYgKHNvcnRSZXZpZXcudmFsdWUgPT0gJ2RhdGUnKSB7CiAgICAgIHRoaXMucmV2aWV3cy5zb3J0KChuMTogYW55LCBuMjogYW55KSA9PiB7CiAgICAgICAgaWYgKG4xLnRpbWVzdGFtcCA+IG4yLnRpbWVzdGFtcCkgewogICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgfQoKICAgICAgICBpZiAobjEudGltZXN0YW1wIDwgbjIudGltZXN0YW1wKSB7CiAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gMDsKICAgICAgfSk7CiAgICB9CiAgfQoKICBzaG93TW9yZVJldmlld3MoKSB7CiAgICB0aGlzLnNob3dSZXZpZXdzICs9IDY7CiAgfQoKICBhc3luYyB1cHZvdGUocmV2aWV3X2lkOiBzdHJpbmcsIGU6IGFueSkgewogICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgaWYodGhpcy5jaGVja1VzZXJXYWxsZXQoKSl7CiAgICAgIGNvbnN0IHNwaW5uZXI9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Vwdm90ZS1zcGlubmVyLScgKyByZXZpZXdfaWQpIGFzIEhUTUxFbGVtZW50OwogICAgICBjb25zdCB1cHZvdGVFbGVtZW50PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1cHZvdGUtJyArIHJldmlld19pZCkgYXMgSFRNTEVsZW1lbnQ7CiAgICAgIGNvbnN0IHVwdm90ZUljb249ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Vwdm90ZS1pY29uLScgKyByZXZpZXdfaWQpIGFzIEhUTUxFbGVtZW50OwogICAgICBzcGlubmVyLmNsYXNzTGlzdC5yZW1vdmUoJ2Qtbm9uZScpOwogICAgICB1cHZvdGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Qtbm9uZScpOwogICAgICB1cHZvdGVJY29uLmNsYXNzTGlzdC5hZGQoJ2Qtbm9uZScpOwogICAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLnJldmlld3Nfc2VyLnVwdm90ZVJldmlldyh0aGlzLnByb2ZpbGUhLmlkLCByZXZpZXdfaWQpOwogICAgICBzcGlubmVyLmNsYXNzTGlzdC5hZGQoJ2Qtbm9uZScpOwogICAgICB1cHZvdGVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2Qtbm9uZScpOwogICAgICB1cHZvdGVJY29uLmNsYXNzTGlzdC5yZW1vdmUoJ2Qtbm9uZScpOwogICAgICBpZiAocmVzLnN0YXR1cyA9PSAyMDApIHsKICAgICAgICBjb25zdCB1cHZvdGVSZXN1bHQgPSByZXMuZGF0YQogICAgICAgIGlmICh0eXBlb2YgdXB2b3RlUmVzdWx0LnR4aWQgIT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgIGNvbnN0IHZvdGUgPSB1cHZvdGVFbGVtZW50IS50ZXh0Q29udGVudDsKICAgICAgICAgIHVwdm90ZUVsZW1lbnQhLmlubmVySFRNTCA9IChwYXJzZUludCh2b3RlISkgKyAxKS50b1N0cmluZygpOwogICAgICAgICAgdGhpcy5mbGFzaCgnU3VjY2Vzc2Z1bGx5IHVwdm90ZWQgcmV2aWV3JywgJ3N1Y2Nlc3MnLCB7dGltZW91dDogNTAwMH0pCiAgICAgICAgfQogICAgICB9IGVsc2UgaWYocmVzLnN0YXR1cyA9PSA1NTUpIHsKICAgICAgICB0aGlzLnNob3dIYW5kY2FzaE1vZGFsID0gdHJ1ZQogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IG1zZyA9IHJlcy5kYXRhLm1lc3NhZ2UKICAgICAgICBpZiAodHlwZW9mIG1zZyAhPSAndW5kZWZpbmVkJykgewogICAgICAgICAgdGhpcy5mbGFzaChtc2csICdlcnJvcicsIHt0aW1lb3V0OiA1MDAwfSkKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIGFzeW5jIHB1cmNoYXNlUmV2aWV3KHJldmlld19pZDogc3RyaW5nKSB7CiAgICBjb25zdCBzcGlubmVyPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwdXJjaGFzZS1zcGlubmVyLScgKyByZXZpZXdfaWQpIGFzIEhUTUxFbGVtZW50OwogICAgY29uc3QgYnV0dG9uPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwdXJjaGFzZS1idXR0b24tJyArIHJldmlld19pZCkgYXMgSFRNTEVsZW1lbnQ7CiAgICBpZih0aGlzLmNoZWNrVXNlcldhbGxldCgpKXsKICAgICAgc3Bpbm5lci5jbGFzc0xpc3QucmVtb3ZlKCdkLW5vbmUnKTsKICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2Qtbm9uZScpCiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMucmV2aWV3c19zZXIuYnV5UmV2aWV3KHJldmlld19pZCkKICAgICAgaWYgKHJlcy5zdGF0dXMgPT0gMjAwKSB7CiAgICAgICAgdGhpcy5mbGFzaCgnU3VjY2Vzc2Z1bGx5IHB1cmNoYXNlZCByZXZpZXcgaW4gdHggJytyZXMuZGF0YS5wYXltZW50VHgsICdzdWNjZXNzJywge3RpbWVvdXQ6IDUwMDB9KTsKICAgICAgfSBlbHNlIGlmIChyZXMuc3RhdHVzID09IDU1NSkgewogICAgICAgIHRoaXMuc2hvd0hhbmRjYXNoTW9kYWwgPSB0cnVlCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5mbGFzaCgnRmFpbGVkIHRvIHB1cmNoYXNlIHJldmlldycsICdlcnJvcicsIHt0aW1lb3V0OiA1MDAwfSkKICAgICAgfQogICAgICBzcGlubmVyLmNsYXNzTGlzdC5hZGQoJ2Qtbm9uZScpCiAgICAgIGF3YWl0IHRoaXMubG9hZFJldmlld3MoKQogICAgfQogIH0KCiAgYXN5bmMgZG93bnZvdGUocmV2aWV3X2lkOiBzdHJpbmcsIGU6IGFueSkgewogICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgaWYodGhpcy5jaGVja1VzZXJXYWxsZXQoKSl7CiAgICAgIGNvbnN0IHNwaW5uZXI9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rvd252b3RlLXNwaW5uZXItJyArIHJldmlld19pZCkgYXMgSFRNTEVsZW1lbnQ7CiAgICAgIGNvbnN0IGRvd252b3RlRWxlbWVudD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZG93bnZvdGUtJyArIHJldmlld19pZCkgYXMgSFRNTEVsZW1lbnQ7CiAgICAgIGNvbnN0IGRvd252b3RlSWNvbj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZG93bnZvdGUtaWNvbi0nICsgcmV2aWV3X2lkKSBhcyBIVE1MRWxlbWVudDsKICAgICAgc3Bpbm5lci5jbGFzc0xpc3QucmVtb3ZlKCdkLW5vbmUnKTsKICAgICAgZG93bnZvdGVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Qtbm9uZScpOwogICAgICBkb3dudm90ZUljb24uY2xhc3NMaXN0LmFkZCgnZC1ub25lJyk7CiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMucmV2aWV3c19zZXIuZG93blJldmlldyh0aGlzLnByb2ZpbGUhLmlkLCByZXZpZXdfaWQpOwogICAgICBzcGlubmVyLmNsYXNzTGlzdC5hZGQoJ2Qtbm9uZScpOwogICAgICBkb3dudm90ZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnZC1ub25lJyk7CiAgICAgIGRvd252b3RlSWNvbi5jbGFzc0xpc3QucmVtb3ZlKCdkLW5vbmUnKTsKICAgICAgaWYgKHJlcy5zdGF0dXMgPT0gMjAwKSB7CiAgICAgICAgY29uc3QgZG93bnZvdGVSZXN1bHQgPSByZXMuZGF0YQogICAgICAgIGlmICh0eXBlb2YgZG93bnZvdGVSZXN1bHQudHhpZCAhPSAndW5kZWZpbmVkJykgewogICAgICAgICAgY29uc3Qgdm90ZSA9IGRvd252b3RlRWxlbWVudCEudGV4dENvbnRlbnQ7CiAgICAgICAgICBkb3dudm90ZUVsZW1lbnQhLmlubmVySFRNTCA9IChwYXJzZUludCh2b3RlISkgKyAxKS50b1N0cmluZygpOwogICAgICAgICAgdGhpcy5mbGFzaCgnU3VjY2Vzc2Z1bGx5IGRvd252b3RlZCByZXZpZXcnLCAnc3VjY2VzcycsIHt0aW1lb3V0OiA1MDAwfSkKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgbXNnID0gcmVzLmRhdGEubWVzc2FnZQogICAgICAgIGlmICh0eXBlb2YgbXNnICE9ICd1bmRlZmluZWQnKSB7CiAgICAgICAgICB0aGlzLmZsYXNoKG1zZywgJ2Vycm9yJywge3RpbWVvdXQ6IDUwMDB9KQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgaGFuZGxlRmlsZURyb3AoZTogYW55KSB7CiAgICBjb25zdCBkcm9wcGVkRmlsZXMgPSBlLmRhdGFUcmFuc2Zlci5maWxlczsKICAgIGlmICghZHJvcHBlZEZpbGVzKSByZXR1cm47CiAgICAvLyB0aGlzIHRpcCwgY29udmVydCBGaWxlTGlzdCB0byBhcnJheQogICAgKFsuLi5kcm9wcGVkRmlsZXNdKS5mb3JFYWNoKChmOiBhbnkpID0+IHsKICAgICAgdGhpcy5maWxlcy5wdXNoKGYpOwogICAgfSk7CiAgICB0aGlzLnN0ZXAgPSAyOwogIH0KCiAgaGFuZGxlRmlsZUlucHV0KGU6IGFueSkgewogICAgbGV0IGZpbGVzID0gZS50YXJnZXQuZmlsZXM7CiAgICBmaWxlcyA9IGUudGFyZ2V0LmZpbGVzCiAgICBpZiAoIWZpbGVzKSByZXR1cm47CiAgICAvLyB0aGlzIHRpcCwgY29udmVydCBGaWxlTGlzdCB0byBhcnJheQogICAgKFsuLi5maWxlc10pLmZvckVhY2goKGY6IEZpbGUpID0+IHsKICAgICAgdGhpcy5maWxlcy5wdXNoKGYpOwogICAgfSk7CiAgICB0aGlzLnN0ZXAgPSAyOwogIH0KCiAgcmVtb3ZlRmlsZShmaWxlS2V5OiBhbnkpIHsKICAgIHRoaXMuZmlsZXMuc3BsaWNlKGZpbGVLZXksIDEpCiAgfQoKICBhc3luYyB1cGxvYWRJbWFnZXMoKSB7CiAgICB0aGlzLnN0ZXAgPSAwOwogICAgdGhpcy5zaG93VXBsb2FkUHJvZ3Jlc3NCYXIgPSB0cnVlOwogICAgbGV0IGkgPSAwOwogICAgbGV0IHN0YXR1cyA9IGZhbHNlOwogICAgY29uc3QgcHJvZ3Jlc3MgPSAxMDAgLyAodGhpcy5maWxlcy5sZW5ndGgpOwogICAgZm9yIChpID0gMDsgaSA8IHRoaXMuZmlsZXMubGVuZ3RoOyBpKyspIHsKICAgICAgLy91cGxvYWQgaW1hZ2VzCiAgICAgIGNvbnN0IHBsYWNlSW1hZ2UgPSBhd2FpdCB0aGlzLnBsYWNlX3Nlci51cGxvYWRQbGFjZUltYWdlKHRoaXMuZmlsZXNbaV0sIHRoaXMucGxhY2VfaWQpOwogICAgICBpZiAocGxhY2VJbWFnZS5zdGF0dXMgIT0gMjAwKSB7CiAgICAgICAgdGhpcy5mbGFzaChwbGFjZUltYWdlWydkYXRhJ11bJ21lc3NhZ2UnXSwgJ2Vycm9yJywge3RpbWVvdXQ6IDUwMDB9KTsKICAgICAgfQogICAgICBpZiAocGxhY2VJbWFnZS5zdGF0dXMgPT0gMjAwKSB7CiAgICAgICAgc3RhdHVzID0gdHJ1ZTsKICAgICAgfQogICAgICB0aGlzLnVwbG9hZFByb2dyZXNzICs9IHBhcnNlSW50KHByb2dyZXNzLnRvRml4ZWQoMikpOwogICAgfQogICAgdGhpcy5zaG93VXBsb2FkUHJvZ3Jlc3NCYXIgPSBmYWxzZTsKICAgIGlmIChzdGF0dXMpIHsKICAgICAgdGhpcy5mbGFzaCgnSW1hZ2UgaGFzIGJlZW4gdXBsb2FkZWQnLCAnc3VjY2VzcycsIHt0aW1lb3V0OiA1MDAwfSk7CiAgICAgIGxvY2F0aW9uLnJlbG9hZCgpOwogICAgfQogIH0KCiAgZmlsZURyYWdJbigpIHsKICAgIGNvbnNvbGUubG9nKCcnKTsKICB9CgogIGZpbGVEcmFnT3V0KCkgewogICAgY29uc29sZS5sb2coJycpOwogIH0KCiAgc2hvd0ltYWdlVXBsb2FkZXIoKSB7CiAgICBpZiAodGhpcy5jaGVja1VzZXJXYWxsZXQoKSkgewogICAgICB0aGlzLnN0ZXAgPSAxOwogICAgfQoKICB9CiAgY29weVRvQ2xpcGJvYXJkKCkgewogICAgY29uc3QgZHVtbXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOwogICAgY29uc3QgdGV4dCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmOwoKICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZHVtbXkpOwogICAgZHVtbXkudmFsdWUgPSB0ZXh0OwogICAgZHVtbXkuc2VsZWN0KCk7CiAgICBkb2N1bWVudC5leGVjQ29tbWFuZCgnY29weScpOwogICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChkdW1teSk7CiAgICB0aGlzLmZsYXNoKCdDb3BpZWQgdG8gY2xpcGJvYXJkJywgJ3N1Y2Nlc3MnLCB7dGltZW91dDogNTAwMH0pCiAgfQoKICBoaWRlSW1hZ2VVcGxvYWRlcigpIHsKICAgIHRoaXMuc3RlcCA9IDA7CiAgICB0aGlzLmZpbGVzID0gW107CiAgfQoKICBjcmVhdGVVcmwoaW1hZ2VGaWxlOiBGaWxlKSB7CiAgICByZXR1cm4gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoaW1hZ2VGaWxlKTsKICB9CgogIGFzeW5jIGFkZEZhdm9yaXRlUGxhY2UocGxhY2VfaWQ6IGFueSkgewogICAgaWYgKHRoaXMuY2hlY2tVc2VyV2FsbGV0KCkpIHsKICAgICAgY29uc3QgYWRkX2Zhdm9yaXRlX3BsYWNlID0gYXdhaXQgdGhpcy5mYXZvcml0ZXNfc2VyLmFkZEZhdm9yaXRlKHRoaXMucHJvZmlsZSEuaWQsICdsb2NhdGlvbicsIHBsYWNlX2lkKTsKICAgICAgaWYgKGFkZF9mYXZvcml0ZV9wbGFjZS5zdGF0dXM9PTIwMCkgewogICAgICAgIHRoaXMuZmxhc2goJ1BsYWNlIGhhcyBiZWVuIGFkZGVkIHRvIHlvdXIgZmF2b3JpdGVzJywgJ3N1Y2Nlc3MnLCB7dGltZW91dDogNTAwMH0pOwogICAgICAgIHRoaXMuY2hlY2tQbGFjZUlzRmF2b3JpdGUoKQogICAgICB9CiAgICAgIGlmKGFkZF9mYXZvcml0ZV9wbGFjZS5zdGF0dXM9PTQwOSl7CiAgICAgICAgdGhpcy5mbGFzaCgnWW91IGhhdmUgYWxyZWFkeSBhZGRlZCB0aGlzIHBsYWNlIGFzIGEgZmF2b3JpdGUnLCAnZXJyb3InLCB7dGltZW91dDogNTAwMH0pOwogICAgICB9CiAgICB9CiAgfQoKICB3cml0ZVJldmlldygpIHsKICAgIGlmICh0aGlzLmNoZWNrVXNlcldhbGxldCgpKSB7CiAgICAgIHRoaXMuZ2V0Um91dGVQYXRoKCduZXdfcmV2aWV3JywgeydwbGFjZV9pZCc6IHRoaXMucGxhY2UhLnBsYWNlX2lkLCAncGxhY2VfbmFtZSc6IHRoaXMucGxhY2UhLm5hbWV9KTsKICAgIH0KICB9CgogIGNoZWNrVXNlcldhbGxldCgpIHsKICAgIGlmICh0aGlzLnByb2ZpbGUpIHsKICAgICAgaWYgKHRoaXMucHJvZmlsZS53YWxsZXQpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRoaXMub3BlbkxvZ2luKCk7CiAgICB9CiAgfQoKICBvcGVuTG9naW4oKSB7CiAgICBpZiAoISh0aGlzLiRyZWZzWydzaWdudXAnXSBhcyBhbnkpLmlzT3BlbigpKSB7CiAgICAgICh0aGlzLiRyZWZzWydsb2dpbiddIGFzIGFueSkuc2hvd01vZGFsKCk7CiAgICB9CiAgfQoKICBvcGVuU2lnbnVwKCkgewogICAgKHRoaXMuJHJlZnNbJ3NpZ251cCddIGFzIGFueSkuc2hvd01vZGFsKCk7CiAgfQoKICBvbkxvZ2luKCkgewogICAgdGhpcy5mbGFzaCgnWW91IGhhdmUgbG9nZ2VkIGluIHN1Y2Nlc3NmdWxseScsICdzdWNjZXNzJywge3RpbWVvdXQ6IDMwMDB9KTsKICAgIGxvY2F0aW9uLnJlbG9hZCgpOwogIH0KCiAgb25TaWdudXAoKSB7CiAgICB0aGlzLmZsYXNoKCdZb3UgaGF2ZSBzaWduZWQgdXAgc3VjY2Vzc2Z1bHknLCAnc3VjY2VzcycsIHt0aW1lb3V0OiAzMDAwfSk7CiAgICBsb2NhdGlvbi5yZWxvYWQoKTsKICB9CiAgYXN5bmMgb25TdWJtaXQodmFsdWU6IGFueSx1c2VySWQ6IGFueSxyZXZpZXdJZDogYW55ICl7CiAgICBjb25zdCBzZW5kVGlwID0gYXdhaXQgdGhpcy5yZXZpZXdzX3Nlci5zZW5kVGlwKHZhbHVlLHVzZXJJZCxyZXZpZXdJZCk7CiAgICBpZiAoc2VuZFRpcC5zdGF0dXMgPT0gMjAwKSB7CiAgICAgIHRoaXMuZmxhc2goJ1lvdXIgVGlwIGhhcyBiZWVuIHNlbnQgc3VjY2Vzc2Z1bGx5JywgJ3N1Y2Nlc3MnLCB7dGltZW91dDogNTAwMH0pOwogICAgICB0aGlzLnRpcFN0YXR1cz10cnVlOwogICAgfWVsc2UgaWYoc2VuZFRpcC5zdGF0dXM9PTU1NSl7CiAgICAgIHRoaXMuc2hvd0hhbmRjYXNoTW9kYWw9dHJ1ZTsKICAgIH1lbHNlewogICAgICB0aGlzLmZsYXNoKHNlbmRUaXAuZGF0YS5tZXNzYWdlLCAnZXJyb3InLCB7dGltZW91dDogNTAwMH0pOwogICAgICB0aGlzLnRpcFN0YXR1cz1mYWxzZTsKICAgIH0KICB9CiAgYXN5bmMgY2hlY2tQbGFjZUlzRmF2b3JpdGUoKXsKICAgIGxldCBmYXZvcml0ZV9wbGFjZXMgPSBhd2FpdCB0aGlzLmZhdm9yaXRlc19zZXIucGxhY2VzKHRoaXMucHJvZmlsZSEuaWQpOwogICAgaWYgKGZhdm9yaXRlX3BsYWNlcy5zdGF0dXMgPT0gMjAwKSB7CiAgICAgIGZhdm9yaXRlX3BsYWNlcyA9IGZhdm9yaXRlX3BsYWNlcy5kYXRhOwogICAgICBjb25zdCBmYXZvcml0ZV9sb2NhdGlvbnMgPSBuZXcgQXJyYXkoZmF2b3JpdGVfcGxhY2VzLmxlbmd0aCkKICAgICAgaWYgKGZhdm9yaXRlX3BsYWNlcyAmJiBmYXZvcml0ZV9wbGFjZXMubGVuZ3RoKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmYXZvcml0ZV9wbGFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGlmKGZhdm9yaXRlX3BsYWNlc1tpXS5mYXZvcml0ZT09dGhpcy5wbGFjZV9pZCl7CiAgICAgICAgICAgIHRoaXMuaXNGYXZvcml0ZT10cnVlOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgIH0KICAgIH0KICB9CgogIG9wZW5JbWFnZU1vZGFsKHBob3RvX3JlZmVyZW5jZTogYW55LGluZGV4OiBudW1iZXIsc291cmNlOiBzdHJpbmcpIHsKCiAgICB0aGlzLm1haW5JbWFnZU1vZGVsPXBob3RvX3JlZmVyZW5jZTsKICAgIHRoaXMubWFpbkltYWdlSW5kZXg9aW5kZXg7Ci8qICAgIHRoaXMuJHJlZnMuUGxhY2VJbWFnZU1vZGFsLnNldEltYWdlKHBob3RvX3JlZmVyZW5jZSk7CiAgICB0aGlzLiRyZWZzLlBsYWNlSW1hZ2VNb2RhbC5zZXRJbmRleChpbmRleCk7Ki8KICAgIGlmKHNvdXJjZT09J2dvb2dsZScpewogICAgICB0aGlzLnNob3dHb29nbGVJbWFnZU1vZGFsID0gIXRoaXMuc2hvd0dvb2dsZUltYWdlTW9kYWw7CiAgICAgIHRoaXMuc2hvd0JyaXRldnVlSW1hZ2VNb2RhbD1mYWxzZTsKICAgICAgdGhpcy5zaG93UmV2aWV3SW1hZ2VNb2RhbD1mYWxzZTsKICAgIH1lbHNlewogICAgICB0aGlzLnNob3dHb29nbGVJbWFnZU1vZGFsPWZhbHNlOwogICAgICB0aGlzLnNob3dCcml0ZXZ1ZUltYWdlTW9kYWw9IXRoaXMuc2hvd0JyaXRldnVlSW1hZ2VNb2RhbDsKICAgICAgdGhpcy5zaG93UmV2aWV3SW1hZ2VNb2RhbD1mYWxzZTsKICAgIH0KCiAgfQogIG9wZW5SZXZpZXdJbWFnZU1vZGVsKHJldmlld19waG90b3M6IGFueSl7CiAgICB0aGlzLnJldmlld1Bob3Rvcz1yZXZpZXdfcGhvdG9zOwogICAgdGhpcy5tYWluUmV2aWV3SW1hZ2VNb2RlbD1yZXZpZXdfcGhvdG9zWzBdLnVybDsKICAgIHRoaXMuc2hvd1Jldmlld0ltYWdlTW9kYWw9IXRoaXMuc2hvd1Jldmlld0ltYWdlTW9kYWw7CiAgICB0aGlzLnNob3dHb29nbGVJbWFnZU1vZGFsPWZhbHNlOwogICAgdGhpcy5zaG93QnJpdGV2dWVJbWFnZU1vZGFsPWZhbHNlOwp9CiAgY2hhbmdlU2hvd1Jldmlld0ltYWdlTW9kYWwoKXsKICAgIHRoaXMuc2hvd1Jldmlld0ltYWdlTW9kYWw9ZmFsc2U7CiAgfQp9Cg=="},{"version":3,"sources":["Place.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAscA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Place.vue","sourceRoot":"src/views/Dashboard/Place","sourcesContent":["<template>\n  <div>\n    <div>\n      <div class=\"alert-container\">\n        <flash-message class=\"myCustomClass\"></flash-message>\n      </div>\n    </div>\n    <div v-if=\"loadingPlace\" class=\"col-12 col-md py-3 py-sm-5 text-center\">\n      <b-spinner class=\"spinner\"/>\n    </div>\n    <div class=\"place-detail\">\n      <div class=\"container-fluid\">\n        <div class=\"row\">\n          <div v-if=\"place\" class=\"col-12 col-md py-3 py-sm-5\">\n            <div class=\"row\">\n              <div class=\"col-12 col-md-8\">\n                <div class=\"pl-0 pl-md-5\">\n                  <!-- Place title -->\n                  <div class=\"row align-items-center\">\n                    <div class=\"col-12 col-md-auto\">\n                      <h2 class=\"place-detail__title\">{{ place.name }}</h2>\n                    </div>\n                    <div class=\"col-12 col-md place-detail__title-actions\">\n                      <button v-on:click=\"addFavoritePlace(place.place_id)\" class=\"btn btn-link custom-tooltip\">\n                        <font-awesome-icon :icon=\"[isFavorite ? 'fas' : 'far', 'heart']\"/>\n                        <span  v-if=\"!checkUserWallet()\"  class=\"custom-tooltip-text custom-tooltip-text-top\">Connect a wallet to your account before you can add to favorite</span>\n                      </button>\n                      <button v-on:click=\"copyToClipboard\" class=\"btn link custom-tooltip\">\n                        <font-awesome-icon :icon=\"['far', 'link']\"/>\n                        <span class=\"custom-tooltip-text custom-tooltip-text-top\">Copy Link</span>\n                      </button>\n                    </div>\n                  </div>\n                  <!-- Place rating -->\n                  <div class=\"row mb-4\">\n                    <div class=\"col\">\n                      <div class=\"place-detail__rating\">\n                        <img src=\"@/assets/images/star.svg\" alt=\"Rating\">\n                        <div v-if=\"place.review_total > 0\" class=\"place-detail__rating-value\">\n                          <span v-if=\"typeof place.britevue_ratings!='undefined'\" class=\"place-detail__rating-value-number\">\n                            {{ place.britevue_ratings.average }}\n                          </span>\n                          <span v-if=\"typeof place.reviews!='undefined'\">({{ place.review_total }} reviews)\n                          </span>\n                        </div>\n                        <div v-else class=\"place-detail__rating-value\">\n                          <span class=\"place-detail__rating-value-number\">\n                            N/A\n                          </span>\n                        </div>\n                      </div>\n                      <ul class=\"place-detail__rating-details\" v-if=\"typeof place.britevue_ratings!='undefined' && place.review_total > 0\">\n                        <li>\n                          <span class=\"mr-2\">Quality</span>\n                          <img src=\"@/assets/images/star_grey.svg\" alt=\"Quality\">\n                          <span>{{ place.britevue_ratings.quality }}</span>\n                        </li>\n                        <li>\n                          <span class=\"mr-2\">Experience</span>\n                          <img src=\"@/assets/images/star_grey.svg\" alt=\"Experience\">\n                          <span>{{ place.britevue_ratings.experience }}</span>\n                        </li>\n                        <li>\n                          <span class=\"mr-2\">Value</span>\n                          <img src=\"@/assets/images/star_grey.svg\" alt=\"Value\">\n                          <span>{{ place.britevue_ratings.value }}</span>\n                        </li>\n                      </ul>\n                      <ul class=\"place-detail__rating-details\" v-else>\n                        <li>\n                          <span class=\"mr-2\">Quality</span>\n                          <img src=\"@/assets/images/star_grey.svg\" alt=\"Quality\">\n                          <span>N/A</span>\n                        </li>\n                        <li>\n                          <span class=\"mr-2\">Experience</span>\n                          <img src=\"@/assets/images/star_grey.svg\" alt=\"Experience\">\n                          <span>N/A</span>\n                        </li>\n                        <li>\n                          <span class=\"mr-2\">Value</span>\n                          <img src=\"@/assets/images/star_grey.svg\" alt=\"Value\">\n                          <span>N/A</span>\n                        </li>\n                      </ul>\n                    </div>\n                  </div>\n                  <!-- Place info\n                  // TODO: All of this needs to be information we control. For now I'm commenting it out\n                  <div class=\"row mb-4\">\n                    <div class=\"col\">\n                      <ul class=\"place-detail__features\">\n                        <li>\n                          <span>$$</span>\n                          {{ place.types[0] }}\n                        </li>\n                                          <li class=\"divider\"></li>\n                                          <li>\n                                            <img src=\"@/assets/images/check.svg\" alt=\"Dine-in\">\n                                            Dine-in\n                                          </li>\n                                          <li>\n                                            <img src=\"@/assets/images/check.svg\" alt=\"Dine-in\">\n                                            Takeaway\n                                          </li>\n                                          <li>\n                                            <img src=\"@/assets/images/x.svg\" alt=\"Dine-in\">\n                                            No-contact delivery\n                                          </li>\n                      </ul>\n                    </div>\n                  </div>-->\n                  <!-- Place actions -->\n                  <div class=\"row\">\n                    <div class=\"col\">\n                      <div class=\"place-detail__actions\">\n                        <button @click=\"writeReview()\"\n                                class=\"btn btn-primary btn-lg custom-tooltip d-block d-sm-inline-block mr-0 mr-sm-3 mb-3 mb-sm-0\">Write a Review\n                          <span v-if=\"!checkUserWallet()\" class=\"custom-tooltip-text custom-tooltip-text-top\">Connect a wallet to your account before you can write a review</span>\n                        </button>\n                        <a v-on:click=\"showImageUploader\" href=\"javascript:;\" class=\"btn btn-outline-primary custom-tooltip d-block d-sm-inline-block\">\n                          <font-awesome-layers full-width class=\"fa-1x mr-1\">\n                            <font-awesome-icon class=\"text-right\" :icon=\"['fal', 'camera']\"/>\n                          </font-awesome-layers>\n                          Add a Photo\n                          <span v-if=\"!checkUserWallet()\" class=\"custom-tooltip-text custom-tooltip-text-top\">Connect a wallet to your account before you can write a review</span>\n                        </a>\n                      </div>\n                      <progress-bar\n                          :options=\"options\"\n                          :value=\"uploadProgress\"\n                          v-show=\"showUploadProgressBar\"\n                      />\n                    </div>\n                  </div>\n                  <!-- Image uploader -->\n                  <div class=\"row\">\n                    <div class=\"col\">\n\n\n                      <div class=\"image-uploader mb-5\" v-show=\"step==1\" id=\"image-uploader\" v-if=\"files.length == 0\" @dragover.prevent @drop.prevent>\n                        <span v-show=\"step > 0\" v-on:click=\"hideImageUploader\" id=\"close-image-uploader\" class=\"image-uploader__close\">\n                          <font-awesome-icon style=\"font-size: 36px;\" :icon=\"['fal', 'times']\"/>\n                        </span>\n                        <div class=\"image-uploader__drag-container\" @dragleave=\"fileDragOut\" @dragover=\"fileDragIn\" @drop=\"handleFileDrop($event)\">\n                          <div class=\"image-uploader__content\">\n                            <p class=\"image-uploader__title\">Drag your photo here</p>\n                            <div class=\"image-uploader__icon\">\n                              <font-awesome-icon :icon=\"['fal', 'camera']\"/>\n                            </div>\n                            <button type=\"button\" class=\"btn btn-outline-primary\">Or Browse Files</button>\n                          </div>\n                          <input type=\"file\" name=\"file-input\" class=\"image-uploader__input\" multiple=\"True\"\n                                 @change=\"handleFileInput($event)\">\n                          <ul style=\"display:none\">\n                            <li v-bind:key=\"index\" v-for=\"(file, index) in files\">\n                              {{ file.name }} ({{ file.size }} b)\n                              <button @click=\"removeFile(index)\" title=\"Remove\">X</button>\n                            </li>\n                          </ul>\n                        </div>\n                      </div>\n\n                      <div v-show=\"step==2\" id=\"images-container\" v-if=\"files.length > 0\" class=\"row image-uploader-list mx-n2\">\n                        <div v-bind:key=\"index\" v-for=\"(file, index) in files\" class=\"col-12 col-sm-6 col-md-4 px-2 my-2\">\n                          <div class=\"image-uploader-list__item\">\n                            <img\n                                :src=\"createUrl(file)\" class=\"image-uploader-list__item-image\">\n                            <span class=\"image-uploader-list__item-delete\" @click=\"removeFile(index)\">\n                              <font-awesome-icon class=\"image-uploader-list__item-delete-icon\" :icon=\"['far', 'trash-alt']\"/>\n                          </span>\n                            <!--<textarea class=\"mt-3\" placeholder=\"Add a caption\"></textarea>-->\n                          </div>\n                        </div>\n                        <div class=\"col-12 px-2 text-center mt-2\">\n                          <button @click=\"uploadImages\" class=\"btn btn-primary\">\n                            <span>\n                              <font-awesome-icon class=\"text-right\" :icon=\"['far', 'arrow-to-top']\"/>\n                            </span>\n                            Upload\n                          </button>\n                        </div>\n                      </div>\n\n                      <div class=\"image-uploader\" v-show=\"step==2\" id=\"image-uploader\" v-if=\"files.length > 0\" @dragover.prevent @drop.prevent>\n                        <span v-show=\"step > 0\" v-on:click=\"hideImageUploader\" id=\"close-image-uploader\" class=\"image-uploader__close\">\n                          <font-awesome-icon style=\"font-size: 36px;\" :icon=\"['fal', 'times']\"/>\n                        </span>\n                        <div class=\"image-uploader__drag-container\" @dragleave=\"fileDragOut\" @dragover=\"fileDragIn\" @drop=\"handleFileDrop($event)\">\n                          <div class=\"image-uploader__content\">\n                            <p class=\"image-uploader__title\">Drag more photos here</p>\n                            <div class=\"image-uploader__icon\">\n                              <font-awesome-icon :icon=\"['fal', 'camera']\"/>\n                            </div>\n                            <button type=\"button\" class=\"btn btn-outline-primary\">Or Browse Files</button>\n                          </div>\n                          <input type=\"file\" name=\"file-input\" class=\"image-uploader__input\" multiple=\"True\"\n                                 @change=\"handleFileInput($event)\">\n                          <ul style=\"display:none\">\n                            <li v-bind:key=\"index\" v-for=\"(file, index) in files\">\n                              {{ file.name }} ({{ file.size }} b)\n                              <button @click=\"removeFile(index)\" title=\"Remove\">X</button>\n                            </li>\n                          </ul>\n                        </div>\n                      </div>\n\n                    </div>\n                  </div>\n                  <div class=\"reviews\">\n                    <div class=\"row mb-4\">\n                      <div class=\"col\">\n                        <h4>Reviews</h4>\n                      </div>\n                      <div class=\"col-auto text-right\">\n                        <select id=\"sort-reviews\" v-on:change=\"sortReviews()\" name=\"sort\" class=\"custom-select sort\">\n                          <option value=\"\">Sort by</option>\n                          <option value=\"name\">Name</option>\n                          <option value=\"date\">Date</option>\n                        </select>\n                      </div>\n                    </div>\n\n                    <div v-if=\"loadingReviews\" class=\"col-auto text-center\">\n                      <b-spinner class=\"spinner\"/>\n                    </div>\n                    <div v-else-if=\"reviews.length == 0\" class=\"col-auto text-center\">\n                      <h4>No reviews yet</h4>\n                    </div>\n\n                    <div class=\"activity-card\" v-for=\"review in reviews.slice(0,showReviews)\" :key=\"review.id\">\n\n                      <!-- OLD Condition applied to the review div <div v-show=\"!review.paywall || review.paywall.cost == 0 || review.user == profile.id || review.paywall.paidFor\" class=\"row no-gutters\"> -->\n\n                      <div class=\"row no-gutters\">\n                        <div class=\"col-12 col-sm-auto pr-0 pr-sm-3 mb-3 mb-sm-0\">\n                          <img @click=\"openReviewImageModel(review.photos)\" v-if=\"review.photos.length > 0\" :src=\"review.photos[0].url\" alt=\"Place\" class=\"activity-card__header-horizontal-image\">\n                          <img v-else src=\"@/assets/images/no-photo-avatar-1.png\" alt=\"Place\" class=\"activity-card__header-horizontal-image\">\n                        </div>\n                        <div class=\"col-12 col-sm\">\n                          <div class=\"activity-card__header\">\n                            <div class=\"row align-items-center\">\n                              <div class=\"col-auto pr-0\">\n                                <img v-if=\"review.userInfo.profilePhoto.url == ''\" class=\"activity-card__header-image\" src=\"@/assets/images/person.png\" :alt=\"review.user.name\">\n                                <img v-else class=\"activity-card__header-image\" :src=\"review.userInfo.profilePhoto.url\" :alt=\"review.user.name\">\n                              </div>\n                              <div class=\"col\">\n                                  <div class=\"row\">\n                                    <div class=\"col\">\n                                      <p class=\"activity-card__header-username clickable\" @click=\"getRoutePath('profile',{'id':review.userInfo.id})\">{{ review.userInfo.firstName }} {{ review.userInfo.lastName }}</p>\n                                    </div>\n                                    <div class=\"col-auto\">\n                                      <p :class=\"review.userInfo.reputation < 2 ? review.userInfo.reputation < 0 ? 'text-danger' : 'text-warning' : 'text-success'\"><strong>Reputation: {{ review.userInfo.reputation }}</strong></p>\n                                    </div>\n                                  </div>\n                                  <p class=\"activity-card__header-date\" >{{ new Date(review.timestamp).toDateString() }}</p>\n                              </div>\n                            </div>\n                          </div>\n                          <div class=\"activity-card__body\">\n                            <div class=\"row\">\n                              <div class=\"col\">\n                                <div class=\"place-card__rating\" :class=\"review.paywall && review.paywall.cost != 0 && review.user != profile.id && !review.paywall.paidFor ? 'blur' : ''\">\n                                  <img src=\"@/assets/images/star.svg\" alt=\"Rating\" />\n                                  <p>\n                                    <span class=\"place-card__rating-value\">{{ review.ratingAverage }}</span>\n                                  </p>\n                                </div>\n                              </div>\n                              <div class=\"col text-right\">\n                                <p><strong>Score: {{ review.score }}</strong></p>\n                              </div>\n                            </div>\n                            <div class=\"row\" v-if=\"review.paywall && review.paywall.cost != 0\">\n                              <div class=\"col text-right\">\n                                <p><strong>Cost: ${{ review.paywall.cost }}</strong></p>\n                              </div>\n                            </div>\n\n                            <p class=\"card-text\" :class=\"review.paywall && review.paywall.cost != 0 && review.user != profile.id && !review.paywall.paidFor ? 'blur' : ''\">{{ review.reviewBody }}</p>\n                            <!--<p class=\"user-rep\">User Rep: &lt;!&ndash;{{ activity.user.reputation }}&ndash;&gt;</p>-->\n                          </div>\n                          <div class=\"activity-card__footer\">\n                            <div class=\"row\" :class=\"review.paywall && review.paywall.cost != 0 && review.user != profile.id && !review.paywall.paidFor ? 'blur' : ''\">\n                              <div class=\"col-auto pr-0\">\n                                <div class=\"activity-card__footer-vote custom-tooltip\" @click=\"upvote(review.id,$event)\">\n                                  <b-spinner :id=\"`upvote-spinner-`+review.id\" class=\"spinner  d-none\"/>\n                                  <img :id=\"`upvote-icon-`+review.id\" src=\"@/assets/images/upvote.svg\" alt=\"Up Vote\">\n                                  <span :id=\"`upvote-`+review.id\">{{ review.upvotes }}</span>\n                                  <span  v-if=\"!checkUserWallet()\"  class=\"custom-tooltip-text custom-tooltip-text-top\">Connect a wallet to your account before you can upvote</span>\n                                </div>\n                              </div>\n                              <div class=\"col-auto\">\n                                <div class=\"activity-card__footer-vote custom-tooltip\" @click=\"downvote(review.id,$event)\">\n                                  <b-spinner :id=\"`downvote-spinner-`+review.id\" class=\"spinner d-none\"/>\n                                  <img  :id=\"`downvote-icon-`+review.id\"  src=\"@/assets/images/downvote.svg\" alt=\"Down Vote\">\n                                  <span :id=\"`downvote-`+review.id\">{{ review.downvotes }}</span>\n                                  <span  v-if=\"!checkUserWallet()\"  class=\"custom-tooltip-text custom-tooltip-text-top\">Connect a wallet to your account before you can downvote</span>\n                                </div>\n                              </div>\n                              <div class=\"col text-right\">\n\n                                <div v-if=\"review.user==profile.id\" class=\"custom-tooltip\">\n                                  <font-awesome-icon v-on:click=\"deleteReview(review.id)\"\n                                                     style=\"color:#FF9800;font-size: 24px;\"\n                                                     class=\"mx-2\" :icon=\"['far', 'trash-alt']\"></font-awesome-icon>\n                                  <span v-if=\"!checkUserWallet()\" class=\"custom-tooltip-text custom-tooltip-text-top\">Connect a wallet to your account before you can delete a review</span>\n                                </div>\n                                <div v-if=\"review.user==profile.id\" class=\"custom-tooltip\">\n                                  <font-awesome-icon v-on:click=\"editReview(review.placeID,place.name,review.id)\"\n                                                     style=\"color:#FF9800;font-size: 24px;\" class=\"mx-2\"\n                                                     :icon=\"['far', 'pen']\"></font-awesome-icon>\n                                  <span v-if=\"!checkUserWallet()\" class=\"custom-tooltip-text custom-tooltip-text-top\">Connect a wallet to your account before you can edit a review</span>\n                                </div>\n\n                                <div v-if=\"review.user!=profile.id\" class=\"earns\">\n                                  <Tip :tip-status=\"tipStatus\" @onSubmit=\"onSubmit\" :user-id=\"review.user\" :review-id=\"review.id\"></Tip>\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                      <div class=\"activity-card__purchase-btn\" v-if=\"review.paywall && review.paywall.cost != 0 && review.user != profile.id && !review.paywall.paidFor\">\n                        <b-spinner :id=\"`purchase-spinner-`+review.id\" class=\"spinner d-none\"/>\n                        <button :id=\"`purchase-button-`+review.id\" class=\"btn btn-secondary\" @click=\"purchaseReview(review.id)\">Purchase ${{ review.paywall.cost }}</button>\n                      </div>\n                    </div>\n                    <div class=\"load-more\" ref=\"show-more-reviews\" :class=\"{'d-none': showReviews > reviews.length}\"\n                         v-on:click=\"showMoreReviews()\">\n                      <img src=\"@/assets/images/arrow_down.svg\" alt=\"Show More ReviewsService\">\n                      <p>Show More ReviewsService</p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"col-12 col-md-4 place-detail__info\">\n                <div class=\"row\">\n                  <div class=\"col-12\">\n                    <div class=\"place-detail__info-address mb-3\">\n                      <b>Address</b>\n                      <p>{{ place.formatted_address }}</p>\n                    </div>\n                    <div class=\"place-detail__info-website mb-3\">\n                      <a :href=\"place.website\" target=\"_blank\">\n                        {{ place.name }} website\n                      </a>\n                    </div>\n                    <div class=\"place-detail__info-phone mb-3\">\n                      <b>Phone</b>\n                      <p>{{ place.international_phone_number }}</p>\n                    </div>\n                    <div class=\"place-detail__info-schedule mb-3\">\n                      <div class=\"place-detail__info-schedule-days\">\n                        <!--start accordion-->\n                        <div v-if=\"typeof place.opening_hours !='undefined'\" class=\"accordion w-100\" role=\"tablist\">\n                          <b-card no-body class=\"mb-1 border-0\">\n                            <b-card-header header-tag=\"header\" class=\"px-0 py-1 border-0\" role=\"tab\"\n                                           style=\"background-color: transparent\">\n                              <!--<b-button block v-b-toggle.accordion-1 variant=\"info\">Accordion 1</b-button>-->\n                              <div v-b-toggle.accordion-1 variant=\"info\" style=\"outline: 0;\">\n                                <div class=\"row\">\n                                  <div class=\"col\">\n                                    <b class=\"schedule-header text-success\" v-if=\"place.opening_hours.open_now==true\">Open now<span> until {{ closingTime() }}</span>\n                                    </b>\n                                    <b class=\"schedule-header text-danger\" v-else>Closed now</b>\n                                  </div>\n                                  <div class=\"col-auto\">\n                                    <font-awesome-icon class=\"text-right\" :icon=\"['fas', 'chevron-down']\"/>\n                                  </div>\n                                </div>\n\n                              </div>\n                            </b-card-header>\n                            <b-collapse id=\"accordion-1\" visible accordion=\"my-accordion\" role=\"tabpanel\">\n                              <b-card-body class=\"px-0 py-1\">\n                                <b-card-text>\n                                  <div class=\"\" v-for=\"item in place.opening_hours.weekday_text\" :key=\"item.index\">\n                                    <p class=\"time\">{{ item }}</p>\n                                  </div>\n                                </b-card-text>\n                              </b-card-body>\n                            </b-collapse>\n                          </b-card>\n                        </div>\n                        <!--end accordion-->\n                      </div>\n                    </div>\n                    <div class=\"place-detail__info-photos\">\n                      <div v-if=\"typeof place.britevue_photos != 'undefined' && place.britevue_photos != null\" class=\"row mx-n1\">\n                        <div class=\"place-detail__info-photos-item col-4 px-1 my-1\" v-for=\"(photo, key) in place.britevue_photos.slice(0, 6)\" :key=\"key\">\n                          <img  v-if=\"photo\"\n                                :src=\"photo.url\"\n                                @error=\"imageUrlAlt\" alt=\"Card image cap\"  @click=\"openImageModal(photo.url,key,'britevue')\">\n                          <img  v-else\n                                src=\"@/assets/images/no-photo-avatar.png\"\n                                alt=\"Card image cap\">\n                          <span @click=\"goToPhotos()\" class=\"img-overlay\"\n                                v-if=\"place.britevue_photos.length > 6 && key === 5\">\n                            <b class=\"img-text\">+{{ place.britevue_photos.length - 6 }}</b>\n                        </span>\n                        </div>\n                      </div>\n                      <div v-if=\"typeof place.photos != 'undefined'\" class=\"row mx-n1\">\n                        <div class=\"place-detail__info-photos-item col-4 px-1 my-1\" v-for=\"(photo, key) in place.photos.slice(0, 6)\" :key=\"key\">\n                          <img  v-if=\"photo\"\n                                :src=\"`https://maps.googleapis.com/maps/api/place/photo?key=AIzaSyDMqrI8hMqiyIPdQUkRUerdohx28Fuv4wE&photo_reference=`+photo.photo_reference+`&maxwidth=300`\"\n                                @error=\"imageUrlAlt\" alt=\"Card image cap\" @click=\"openImageModal(photo.photo_reference,key,'google')\">\n                          <img  v-else\n                                src=\"@/assets/images/no-photo-avatar.png\"\n                                alt=\"Card image cap\">\n                          <span @click=\"goToPhotos()\" class=\"place-detail__info-photos-item-more\" v-if=\"place.photos.length > 6 && key === 5\">\n                            +{{ place.photos.length - 6 }}\n                        </span>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-12 col-md-3 px-0\">\n            <div class=\"find-places__map-wrapper\">\n              <div id=\"map\" ref=\"map\" class=\"find-places__map-sticky\"></div>\n            </div>\n          </div>\n        </div>\n        <div class=\"row\">\n          <div class=\"col-12\">\n            <Modal :show-handcash-modal=\"showHandcashModal\"  :title=\"'Top Up!'\" :body=\"'You need to reset your spending limit in the Handcash app'\" :icon=\"'times-circle'\" :actions=\"[{ text:'Open Handcash', url:'https://app.handcash.io/', variant:'handcash', target:'_blank' }]\"></Modal>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div v-if=\"place\">\n      <div v-if=\"typeof place.photos != 'undefined'\">\n        <ImageModal v-if=\"place.photos && place.photos.length > 0\" :source=\"'google'\"  ref=\"PlaceImageModal\" :show-image-modal=\"showGoogleImageModal\" :main-image-model=\"mainImageModel\" :main-image-index=\"mainImageIndex\" :placeName=\"place.name\" :imagesList=\"place.photos\"></ImageModal>\n      </div>\n      <div v-if=\"typeof place.britevue_photos != 'undefined' \">\n        <ImageModal v-if=\"place.britevue_photos && place.britevue_photos.length > 0\" :source=\"'britevue'\" :show-image-modal=\"showBritevueImageModal\" :main-image-model=\"mainImageModel\" :main-image-index=\"mainImageIndex\" :placeName=\"place.name\" :imagesList=\"place.britevue_photos\"></ImageModal>\n      </div>\n    </div>\n    <div>\n      <ReviewImageModal @changeShowReviewImageModal=\"changeShowReviewImageModal\" ref=\"reviewImageModal\" :photos=\"reviewPhotos\" :show-review-image-modal=\"showReviewImageModal\" :main-review-image-model=\"mainReviewImageModel\"></ReviewImageModal>\n    </div>\n\n\n    <Login ref=\"login\" @openSignup=\"openSignup\" @onLogin=\"onLogin\"></Login>\n    <Signup ref=\"signup\" @onSignup=\"onSignup\"></Signup>\n  </div>\n</template>\n<style lang=\"scss\" src=\"./Place.scss\" scoped></style>\n<script lang=\"ts\">\nimport {Component, Inject, Vue} from \"vue-property-decorator\";\nimport {IGooglePlace} from \"@/interfaces/IGooglePlace\";\nimport {Loader, LoaderOptions} from \"google-maps\";\n\nimport Tip from \"@/components/Tip/Tip.vue\";\nimport {PlaceService} from \"@/services/PlaceService\";\nimport {ReviewsService} from \"@/services/ReviewsService\";\nimport {UserService} from \"@/services/UserService\";\nimport {IUser} from \"@/interfaces/IUser\";\nimport {FavoritesService} from \"@/services/FavoritesService\";\nimport Login from \"@/components/Login/Login.vue\";\nimport Signup from \"@/components/Signup/Signup.vue\";\nimport Modal from \"@/components/Modal/Modal.vue\";\nimport ImageModal from \"@/components/ImageModal/ImageModal.vue\";\nimport ReviewImageModal from  \"@/components/ImageModal/ReviewImageModal.vue\";\n\n@Component({\n  components: {\n    Login,\n    Signup,\n    Tip,\n    Modal,\n    ImageModal,\n    ReviewImageModal\n  },\n  metaInfo:{\n    title: \"Britevue - Blockchain verified reviews where reviewers get paid\",\n    meta: [\n      { name:'title',content:'Britevue - Blockchain verified reviews where reviewers get paid'},\n      { name: 'description', content:  'Begin earning money for your reviews of businesses and places with Britevue. We will pay you for information about your hometown to get started!'},\n      { itemprop: 'name', content: \"Britevue\"},\n      { itemprop: 'description', content: \"Begin earning money for your reviews of businesses and places with Britevue. We will pay you for information about your hometown to get started!\"},\n      { itemprop: 'image', content:  require('@/assets/images/logo_black.svg')},\n      { property: 'og:type', content: \"website\"},\n      { property: 'og:url', content: \"https://britevue.com/\"},\n      { property: 'og:title', content: \"Britevue - Blockchain verified reviews where reviewers get paid\"},\n      { property: 'og:description', content: \"Begin earning money for your reviews of businesses and places with Britevue. We will pay you for information about your hometown to get started!\"},\n      { property: 'og:image', content:  require('@/assets/images/logo_black.svg')},\n      { property: 'og:site_name', content: 'britevue'},\n      { name: 'twitter:card', content: \"summary_large_image\"},\n      { name: 'twitter:url', content: \"https://britevue.com/\"},\n      { name: 'twitter:title', content: \"Britevue - Blockchain verified reviews where reviewers get paid\"},\n      { name: 'twitter:description', content: \"Begin earning money for your reviews of businesses and places with Britevue. We will pay you for information about your hometown to get started!\"},\n      { name: 'twitter:image', content: require('@/assets/images/logo_black.svg') },\n    ]\n  }\n})\nexport default class Place extends Vue {\n  place_id: string;\n  place: IGooglePlace | null;\n\n  @Inject('favoritesService')\n  favorites_ser!: FavoritesService;\n\n  @Inject('placeService')\n  place_ser!: PlaceService;\n\n  @Inject('reviewsService')\n  reviews_ser!: ReviewsService;\n  reviews = [];\n  showReviews: number;\n  @Inject('userService')\n  user_service!: UserService;\n  profile: IUser | null = null;\n  files: File[] = [];\n  step: number;\n  uploadProgress: number;\n  showUploadProgressBar: boolean;\n  options: any;\n  flash: any;\n  tipStatus: boolean;\n  loadingReviews: boolean;\n  loadingPlace: boolean;\n  isFavorite: boolean;\n  showHandcashModal: boolean;\n  showGoogleImageModal: boolean;\n  showBritevueImageModal: boolean;\n  mainImageModel: string;\n  mainImageIndex: number;\n  reviewPhotos: [];\n  showReviewImageModal: boolean;\n  mainReviewImageModel: string;\n\n\n  constructor() {\n    super();\n    this.place_id = '';\n    this.showReviews = 6;\n    if (typeof this.$route.params.id != 'undefined') {\n      this.place_id = this.$route.params.id;\n    } else {\n      this.$router.push({name: \"dashboard\"});\n    }\n    this.place = null;\n    this.step = 0;\n    this.uploadProgress = 0;\n    this.showUploadProgressBar = false;\n    this.loadingReviews = true;\n    this.loadingPlace = true\n    this.options = {\n      text: {\n        color: '#FFFFFF',\n        shadowEnable: true,\n        shadowColor: '#000000',\n        fontSize: 14,\n        fontFamily: 'Helvetica',\n        dynamicPosition: false,\n        hideText: false\n      },\n      progress: {\n        color: '#cc7a00',\n        backgroundColor: '#333333'\n      },\n      layout: {\n        height: 35,\n        width: 140,\n        verticalTextAlign: 61,\n        horizontalTextAlign: 43,\n        zeroOffset: 0,\n        strokeWidth: 30,\n        progressPadding: 0,\n        type: 'line'\n      }\n    }\n\n    this.user_service.updateUserLocalStorage(\"\")\n    const user = this.user_service.getCurrentUser();\n    if (user) {\n      this.profile = user;\n      //check user token is expired\n      const checkUser = this.user_service.getUser(this.profile.id);\n    }\n    this.tipStatus=false;\n    this.isFavorite=false;\n    this.showHandcashModal=false;\n    this.showGoogleImageModal=false;\n    this.showBritevueImageModal=false;\n    this.mainImageModel= '';\n    this.mainImageIndex=0;\n    this.reviewPhotos=[];\n    this.showReviewImageModal=false;\n    this.mainReviewImageModel='';\n  }\n\n\n  async mounted() {\n    if (this.$route.query.token != null && this.$route.query.username != null) {\n      const tokenObj = {\n        username: this.$route.query.username,\n        token: this.$route.query.token,\n        expires_at: this.$route.query.expires_at\n      }\n      localStorage.setItem('token', JSON.stringify(tokenObj))\n      await this.user_service.updateUserLocalStorage(this.$route.query.username as string)\n    } else {\n      await this.user_service.updateUserLocalStorage(\"\");\n    }\n    try {\n      this.loadingPlace = true\n      await this.loadPlaceDetail();\n      await this.loadMap();\n      this.loadingPlace = false\n      await this.loadReviews();\n      await this.checkPlaceIsFavorite();\n    } catch(e) {\n      this.openLogin()\n    }\n  }\n\n  async deleteReview(review_id: string) {\n    if (this.checkUserWallet()) {\n      if(confirm('Are you sure you want to delete this review')){\n        const deleteReview = await this.reviews_ser.deleteReview(review_id);\n        if (deleteReview.status == 200) {\n          this.reviews = []\n          this.loadReviews()\n        } else {\n          this.flash(\"Had a problem deleting review\", 'error', {timeout: 10000});\n        }\n      }\n    }\n\n  }\n\n  async editReview(place_id: string, place_name: string, review_id: string) {\n    if (this.checkUserWallet()) {\n      this.getRoutePath('new_review', {'place_id': place_id, 'place_name': place_name, 'review_id': review_id});\n    }\n  }\n\n  async loadPlaceDetail() {\n    //check first if a place is a brite-vue place , if not fetch fetch from google\n    const brite_place = await this.place_ser.getBriteLocation(this.place_id);\n    if (brite_place.status == 200) {\n      this.place = brite_place.data;\n    } else {\n\n      const google_place = await this.place_ser.getGoogleLocation(this.place_id);\n      if (google_place.status==200) {\n        this.place = google_place.data;\n      }\n      if(brite_place.status==500 && google_place.status==500){\n        this.flash(\"Place Not Found\", 'error', {timeout: 10000});\n      }\n    }\n  }\n\n  async loadMap() {\n    const options: LoaderOptions = {/* todo */};\n    const loader = new Loader('AIzaSyDMqrI8hMqiyIPdQUkRUerdohx28Fuv4wE', options);\n    const google = await loader.load();\n    /* eslint-disable @typescript-eslint/no-explicit-any*/\n    const con: any = this.$refs.map;\n    let lat = -34.397;\n    let lng = 150.644;\n    if (this.place != null && this.place.geometry != null && this.place.geometry.location != null) {\n      lat = this.place.geometry.location.lat\n      lng = this.place.geometry.location.lng\n    }\n    //load map\n    new google.maps.Map(con, {\n      center: {lat: lat, lng: lng},\n      zoom: 15,\n    });\n  }\n\n  tip(amount: string) {\n    console.log('tipping:', amount);\n  }\n\n  goToPhotos() {\n    this.getRoutePath('place_photos', {'place': this.place});\n  }\n\n  async loadReviews() {\n    this.loadingReviews = true\n    let reviews = await this.reviews_ser.getPlaceReviews(this.place_id);\n    if (reviews.status==200) {\n      reviews=reviews.data;\n      let i;\n      for(i=0;i<reviews.length;i++){\n        const userInfo=await this.user_service.getUser(reviews[i].user);\n        if (userInfo.status==200) {\n          reviews[i].userInfo=userInfo.data;\n        }\n      }\n      this.reviews = reviews;\n    }\n    this.loadingReviews = false\n  }\n\n  closingTime() {\n    const dt = new Date();\n    const dayOfTheWeek = dt.getDay();\n    if (this.place == null || this.place.opening_hours == null || this.place.opening_hours.periods == null) {\n      return ''\n    }\n    let hours;\n    let minutes;\n    let shift;\n    if(this.place.opening_hours.open_now==true){\n      if(this.place.opening_hours.periods.length==7){\n        if(typeof this.place.opening_hours.periods[dayOfTheWeek].close.time!='undefined'){\n          hours=this.place.opening_hours.periods[dayOfTheWeek].close.time.substring(0,2);\n          minutes=this.place.opening_hours.periods[dayOfTheWeek].close.time.substring(2,4);\n          shift='AM';\n          if(hours > 12){\n            hours-=12;\n            shift='PM';\n          }\n          return hours+':'+minutes+' '+shift;\n        }\n      }else if(this.place.opening_hours.periods.count==1){\n        if(typeof this.place.opening_hours.periods[0].close.time!='undefined'){\n          hours=this.place.opening_hours.periods[0].close.time.substring(0,2);\n          minutes=this.place.opening_hours.periods[0].close.time.substring(2,4);\n          shift='AM';\n          if(hours > 12){\n            hours-=12;\n            shift='PM';\n          }\n          return hours+':'+minutes+' '+shift;\n        }\n      }\n    }\n\n    return '';\n  }\n\n  imageUrlAlt(event: any) {\n    event.target.src = require('@/assets/images/no-photo-avatar.png');\n  }\n\n  getRoutePath(name: string, parameters: any) {\n\n    return this.$router.push({name: name, params: parameters});\n  }\n\n  sortReviews() {\n\n    const sortReview = document.getElementById('sort-reviews') as HTMLInputElement;\n\n    if (sortReview.value == 'name') {\n      this.reviews.sort((n1: any, n2: any) => {\n        if (n1.user > n2.user) {\n          return 1;\n        }\n\n        if (n1.user < n2.user) {\n          return -1;\n        }\n\n        return 0;\n      });\n    }\n    if (sortReview.value == 'date') {\n      this.reviews.sort((n1: any, n2: any) => {\n        if (n1.timestamp > n2.timestamp) {\n          return 1;\n        }\n\n        if (n1.timestamp < n2.timestamp) {\n          return -1;\n        }\n\n        return 0;\n      });\n    }\n  }\n\n  showMoreReviews() {\n    this.showReviews += 6;\n  }\n\n  async upvote(review_id: string, e: any) {\n    e.preventDefault();\n    if(this.checkUserWallet()){\n      const spinner=document.getElementById('upvote-spinner-' + review_id) as HTMLElement;\n      const upvoteElement=document.getElementById('upvote-' + review_id) as HTMLElement;\n      const upvoteIcon=document.getElementById('upvote-icon-' + review_id) as HTMLElement;\n      spinner.classList.remove('d-none');\n      upvoteElement.classList.add('d-none');\n      upvoteIcon.classList.add('d-none');\n      const res = await this.reviews_ser.upvoteReview(this.profile!.id, review_id);\n      spinner.classList.add('d-none');\n      upvoteElement.classList.remove('d-none');\n      upvoteIcon.classList.remove('d-none');\n      if (res.status == 200) {\n        const upvoteResult = res.data\n        if (typeof upvoteResult.txid != 'undefined') {\n          const vote = upvoteElement!.textContent;\n          upvoteElement!.innerHTML = (parseInt(vote!) + 1).toString();\n          this.flash('Successfully upvoted review', 'success', {timeout: 5000})\n        }\n      } else if(res.status == 555) {\n        this.showHandcashModal = true\n      } else {\n        const msg = res.data.message\n        if (typeof msg != 'undefined') {\n          this.flash(msg, 'error', {timeout: 5000})\n        }\n      }\n    }\n  }\n\n  async purchaseReview(review_id: string) {\n    const spinner=document.getElementById('purchase-spinner-' + review_id) as HTMLElement;\n    const button=document.getElementById('purchase-button-' + review_id) as HTMLElement;\n    if(this.checkUserWallet()){\n      spinner.classList.remove('d-none');\n      button.classList.add('d-none')\n      const res = await this.reviews_ser.buyReview(review_id)\n      if (res.status == 200) {\n        this.flash('Successfully purchased review in tx '+res.data.paymentTx, 'success', {timeout: 5000});\n      } else if (res.status == 555) {\n        this.showHandcashModal = true\n      } else {\n        this.flash('Failed to purchase review', 'error', {timeout: 5000})\n      }\n      spinner.classList.add('d-none')\n      await this.loadReviews()\n    }\n  }\n\n  async downvote(review_id: string, e: any) {\n    e.preventDefault();\n    if(this.checkUserWallet()){\n      const spinner=document.getElementById('downvote-spinner-' + review_id) as HTMLElement;\n      const downvoteElement=document.getElementById('downvote-' + review_id) as HTMLElement;\n      const downvoteIcon=document.getElementById('downvote-icon-' + review_id) as HTMLElement;\n      spinner.classList.remove('d-none');\n      downvoteElement.classList.add('d-none');\n      downvoteIcon.classList.add('d-none');\n      const res = await this.reviews_ser.downReview(this.profile!.id, review_id);\n      spinner.classList.add('d-none');\n      downvoteElement.classList.remove('d-none');\n      downvoteIcon.classList.remove('d-none');\n      if (res.status == 200) {\n        const downvoteResult = res.data\n        if (typeof downvoteResult.txid != 'undefined') {\n          const vote = downvoteElement!.textContent;\n          downvoteElement!.innerHTML = (parseInt(vote!) + 1).toString();\n          this.flash('Successfully downvoted review', 'success', {timeout: 5000})\n        }\n      } else {\n        const msg = res.data.message\n        if (typeof msg != 'undefined') {\n          this.flash(msg, 'error', {timeout: 5000})\n        }\n      }\n    }\n  }\n\n  handleFileDrop(e: any) {\n    const droppedFiles = e.dataTransfer.files;\n    if (!droppedFiles) return;\n    // this tip, convert FileList to array\n    ([...droppedFiles]).forEach((f: any) => {\n      this.files.push(f);\n    });\n    this.step = 2;\n  }\n\n  handleFileInput(e: any) {\n    let files = e.target.files;\n    files = e.target.files\n    if (!files) return;\n    // this tip, convert FileList to array\n    ([...files]).forEach((f: File) => {\n      this.files.push(f);\n    });\n    this.step = 2;\n  }\n\n  removeFile(fileKey: any) {\n    this.files.splice(fileKey, 1)\n  }\n\n  async uploadImages() {\n    this.step = 0;\n    this.showUploadProgressBar = true;\n    let i = 0;\n    let status = false;\n    const progress = 100 / (this.files.length);\n    for (i = 0; i < this.files.length; i++) {\n      //upload images\n      const placeImage = await this.place_ser.uploadPlaceImage(this.files[i], this.place_id);\n      if (placeImage.status != 200) {\n        this.flash(placeImage['data']['message'], 'error', {timeout: 5000});\n      }\n      if (placeImage.status == 200) {\n        status = true;\n      }\n      this.uploadProgress += parseInt(progress.toFixed(2));\n    }\n    this.showUploadProgressBar = false;\n    if (status) {\n      this.flash('Image has been uploaded', 'success', {timeout: 5000});\n      location.reload();\n    }\n  }\n\n  fileDragIn() {\n    console.log('');\n  }\n\n  fileDragOut() {\n    console.log('');\n  }\n\n  showImageUploader() {\n    if (this.checkUserWallet()) {\n      this.step = 1;\n    }\n\n  }\n  copyToClipboard() {\n    const dummy = document.createElement('input');\n    const text = window.location.href;\n\n    document.body.appendChild(dummy);\n    dummy.value = text;\n    dummy.select();\n    document.execCommand('copy');\n    document.body.removeChild(dummy);\n    this.flash('Copied to clipboard', 'success', {timeout: 5000})\n  }\n\n  hideImageUploader() {\n    this.step = 0;\n    this.files = [];\n  }\n\n  createUrl(imageFile: File) {\n    return window.URL.createObjectURL(imageFile);\n  }\n\n  async addFavoritePlace(place_id: any) {\n    if (this.checkUserWallet()) {\n      const add_favorite_place = await this.favorites_ser.addFavorite(this.profile!.id, 'location', place_id);\n      if (add_favorite_place.status==200) {\n        this.flash('Place has been added to your favorites', 'success', {timeout: 5000});\n        this.checkPlaceIsFavorite()\n      }\n      if(add_favorite_place.status==409){\n        this.flash('You have already added this place as a favorite', 'error', {timeout: 5000});\n      }\n    }\n  }\n\n  writeReview() {\n    if (this.checkUserWallet()) {\n      this.getRoutePath('new_review', {'place_id': this.place!.place_id, 'place_name': this.place!.name});\n    }\n  }\n\n  checkUserWallet() {\n    if (this.profile) {\n      if (this.profile.wallet) {\n        return true;\n      } else {\n        return false;\n      }\n    } else {\n      this.openLogin();\n    }\n  }\n\n  openLogin() {\n    if (!(this.$refs['signup'] as any).isOpen()) {\n      (this.$refs['login'] as any).showModal();\n    }\n  }\n\n  openSignup() {\n    (this.$refs['signup'] as any).showModal();\n  }\n\n  onLogin() {\n    this.flash('You have logged in successfully', 'success', {timeout: 3000});\n    location.reload();\n  }\n\n  onSignup() {\n    this.flash('You have signed up successfuly', 'success', {timeout: 3000});\n    location.reload();\n  }\n  async onSubmit(value: any,userId: any,reviewId: any ){\n    const sendTip = await this.reviews_ser.sendTip(value,userId,reviewId);\n    if (sendTip.status == 200) {\n      this.flash('Your Tip has been sent successfully', 'success', {timeout: 5000});\n      this.tipStatus=true;\n    }else if(sendTip.status==555){\n      this.showHandcashModal=true;\n    }else{\n      this.flash(sendTip.data.message, 'error', {timeout: 5000});\n      this.tipStatus=false;\n    }\n  }\n  async checkPlaceIsFavorite(){\n    let favorite_places = await this.favorites_ser.places(this.profile!.id);\n    if (favorite_places.status == 200) {\n      favorite_places = favorite_places.data;\n      const favorite_locations = new Array(favorite_places.length)\n      if (favorite_places && favorite_places.length) {\n        for (let i = 0; i < favorite_places.length; i++) {\n          if(favorite_places[i].favorite==this.place_id){\n            this.isFavorite=true;\n          }\n        }\n\n      }\n    }\n  }\n\n  openImageModal(photo_reference: any,index: number,source: string) {\n\n    this.mainImageModel=photo_reference;\n    this.mainImageIndex=index;\n/*    this.$refs.PlaceImageModal.setImage(photo_reference);\n    this.$refs.PlaceImageModal.setIndex(index);*/\n    if(source=='google'){\n      this.showGoogleImageModal = !this.showGoogleImageModal;\n      this.showBritevueImageModal=false;\n      this.showReviewImageModal=false;\n    }else{\n      this.showGoogleImageModal=false;\n      this.showBritevueImageModal=!this.showBritevueImageModal;\n      this.showReviewImageModal=false;\n    }\n\n  }\n  openReviewImageModel(review_photos: any){\n    this.reviewPhotos=review_photos;\n    this.mainReviewImageModel=review_photos[0].url;\n    this.showReviewImageModal=!this.showReviewImageModal;\n    this.showGoogleImageModal=false;\n    this.showBritevueImageModal=false;\n}\n  changeShowReviewImageModal(){\n    this.showReviewImageModal=false;\n  }\n}\n</script>\n"]}]}